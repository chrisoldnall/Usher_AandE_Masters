geom_point()+
geom_line()+
geom_vline(xintercept = as.Date("2023-08-01"), color="orange", linewidth=.5)+
annotate(geom="text", x=as.Date("2023-03-01"), y=0.0325, size=3, label="Actual")+
annotate(geom="text", x=as.Date("2024-01-01"), y=0.0325, size=3, label="Predicted")+
geom_segment(aes(x=as.Date("2023-01-01"), y=0.0335, xend = as.Date("2022-12-01"), yend = 0.0335), arrow=arrow(length = unit(0.3, 'cm')))+
#annotate(geom="text", x=as.Date("2023-03-01"), y=0.0340, size=3, label= sprintf('\u2191'))+
labs(x="Year",
y="Attendance rate",
col="NHS Board Name")
ggplot(data=Orkney_Glasgow_rates2018to2023, aes(x=Month, y=attendancerate, ggroup=NHSBoardName, color=NHSBoardName))+
geom_point()+
geom_line()+
geom_vline(xintercept = as.Date("2023-08-01"), color="orange", linewidth=.5)+
annotate(geom="text", x=as.Date("2023-03-01"), y=0.0325, size=3, label="Actual")+
annotate(geom="text", x=as.Date("2024-01-01"), y=0.0325, size=3, label="Predicted")+
geom_segment(aes(x=as.Date("2023-03-01"), y=0.0335, xend = as.Date("2022-12-01"), yend = 0.0335), arrow=arrow(length = unit(0.3, 'cm')))+
#annotate(geom="text", x=as.Date("2023-03-01"), y=0.0340, size=3, label= sprintf('\u2191'))+
labs(x="Year",
y="Attendance rate",
col="NHS Board Name")
ggplot(data=Orkney_Glasgow_rates2018to2023, aes(x=Month, y=attendancerate, ggroup=NHSBoardName, color=NHSBoardName))+
geom_point()+
geom_line()+
geom_vline(xintercept = as.Date("2023-08-01"), color="orange", linewidth=.5)+
annotate(geom="text", x=as.Date("2023-03-01"), y=0.0325, size=3, label="Actual")+
annotate(geom="text", x=as.Date("2024-01-01"), y=0.0325, size=3, label="Predicted")+
geom_segment(aes(x=as.Date("2023-03-01"), y=0.0335, xend = as.Date("2022-12-01"), yend = 0.0335), arrow=arrow(length = unit(0.3, 'cm')), color='black')+
#annotate(geom="text", x=as.Date("2023-03-01"), y=0.0340, size=3, label= sprintf('\u2191'))+
labs(x="Year",
y="Attendance rate",
col="NHS Board Name")
ggplot(data=Orkney_Glasgow_rates2018to2023, aes(x=Month, y=attendancerate, ggroup=NHSBoardName, color=NHSBoardName))+
geom_point()+
geom_line()+
geom_vline(xintercept = as.Date("2023-08-01"), color="orange", linewidth=.5)+
annotate(geom="text", x=as.Date("2023-03-01"), y=0.0325, size=3, label="Actual")+
annotate(geom="text", x=as.Date("2024-01-01"), y=0.0325, size=3, label="Predicted")+
geom_segment(aes(x=as.Date("2023-06-01"), y=0.0335, xend = as.Date("2022-12-01"), yend = 0.0335), arrow=arrow(length = unit(0.3, 'cm')), color='black')+
#annotate(geom="text", x=as.Date("2023-03-01"), y=0.0340, size=3, label= sprintf('\u2191'))+
labs(x="Year",
y="Attendance rate",
col="NHS Board Name")
gplot(data=Orkney_Glasgow_rates2018to2023, aes(x=Month, y=attendancerate, ggroup=NHSBoardName, color=NHSBoardName))+
geom_point()+
geom_line()+
geom_vline(xintercept = as.Date("2023-08-01"), color="orange", linewidth=.5)+
annotate(geom="text", x=as.Date("2023-03-01"), y=0.0325, size=3, label="Actual")+
annotate(geom="text", x=as.Date("2024-01-01"), y=0.0325, size=3, label="Predicted")+
geom_segment(aes(x=as.Date("2023-06-01"), y=0.0335, xend = as.Date("2022-12-01"), yend = 0.0335), arrow=arrow(length = unit(0.3, 'cm')), color='black')+
geom_segment(aes(x=as.Date("2024-01-01"), y=0.0335, xend = as.Date("2024-06-01"), yend = 0.0335), arrow=arrow(length = unit(0.3, 'cm')), color='black')+#annotate(geom="text", x=as.Date("2023-03-01"), y=0.0340, size=3, label= sprintf('\u2191'))+
labs(x="Year",
y="Attendance rate",
col="NHS Board Name")
ggplot(data=Orkney_Glasgow_rates2018to2023, aes(x=Month, y=attendancerate, ggroup=NHSBoardName, color=NHSBoardName))+
geom_point()+
geom_line()+
geom_vline(xintercept = as.Date("2023-08-01"), color="orange", linewidth=.5)+
annotate(geom="text", x=as.Date("2023-03-01"), y=0.0325, size=3, label="Actual")+
annotate(geom="text", x=as.Date("2024-01-01"), y=0.0325, size=3, label="Predicted")+
geom_segment(aes(x=as.Date("2023-06-01"), y=0.0335, xend = as.Date("2022-12-01"), yend = 0.0335), arrow=arrow(length = unit(0.3, 'cm')), color='black')+
geom_segment(aes(x=as.Date("2024-01-01"), y=0.0335, xend = as.Date("2024-06-01"), yend = 0.0335), arrow=arrow(length = unit(0.3, 'cm')), color='black')+#annotate(geom="text", x=as.Date("2023-03-01"), y=0.0340, size=3, label= sprintf('\u2191'))+
labs(x="Year",
y="Attendance rate",
col="NHS Board Name")
ggplot(data=Orkney_Glasgow_rates2018to2023, aes(x=Month, y=attendancerate, ggroup=NHSBoardName, color=NHSBoardName))+
geom_point()+
geom_line()+
geom_vline(xintercept = as.Date("2023-08-01"), color="orange", linewidth=.5)+
annotate(geom="text", x=as.Date("2023-03-01"), y=0.0325, size=3, label="Actual")+
annotate(geom="text", x=as.Date("2024-01-01"), y=0.0325, size=3, label="Predicted")+
geom_segment(aes(x=as.Date("2023-06-01"), y=0.0335, xend = as.Date("2022-12-01"), yend = 0.0335), arrow=arrow(length = unit(0.3, 'cm')), color='black')+
geom_segment(aes(x=as.Date("2023-11-01"), y=0.0335, xend = as.Date("2024-04-01"), yend = 0.0335), arrow=arrow(length = unit(0.3, 'cm')), color='black')+#annotate(geom="text", x=as.Date("2023-03-01"), y=0.0340, size=3, label= sprintf('\u2191'))+
labs(x="Year",
y="Attendance rate",
col="NHS Board Name")
Orkney_Glasgow_predict_rates2018to2023 <- ggplot(data=Orkney_Glasgow_rates2018to2023, aes(x=Month, y=attendancerate, ggroup=NHSBoardName, color=NHSBoardName))+
geom_point()+
geom_line()+
geom_vline(xintercept = as.Date("2023-08-01"), color="orange", linewidth=.5)+
annotate(geom="text", x=as.Date("2023-03-01"), y=0.0325, size=3, label="Actual")+
annotate(geom="text", x=as.Date("2024-01-01"), y=0.0325, size=3, label="Predicted")+
geom_segment(aes(x=as.Date("2023-06-01"), y=0.0335, xend = as.Date("2022-12-01"), yend = 0.0335), arrow=arrow(length = unit(0.3, 'cm')), color='black')+
geom_segment(aes(x=as.Date("2023-11-01"), y=0.0335, xend = as.Date("2024-04-01"), yend = 0.0335), arrow=arrow(length = unit(0.3, 'cm')), color='black')+#annotate(geom="text", x=as.Date("2023-03-01"), y=0.0340, size=3, label= sprintf('\u2191'))+
labs(x="Year",
y="Attendance rate",
col="NHS Board Name")
save_plot("Output/Orkney_Glasgow_predict_rates2018to2023vline.svg", fig=Orkney_Glasgow_predict_rates2018to2023, width=14, height=12)
ggplot(data=Orkney_Glasgow_rates2018to2023, aes(x=Month, y=attendancerate, ggroup=NHSBoardName, color=NHSBoardName))+
geom_point()+
geom_line()+
geom_vline(xintercept = as.Date("2023-08-01"), color="orange", linewidth=.5)+
annotate(geom="text", x=as.Date("2023-03-01"), y=0.0325, size=3, label="Actual")+
annotate(geom="text", x=as.Date("2024-01-01"), y=0.0325, size=3, label="Predicted")+
geom_segment(aes(x=as.Date("2023-06-01"), y=0.0335, xend = as.Date("2022-12-01"), yend = 0.0335), arrow=arrow(length = unit(0.3, 'cm')), color='black')+
geom_segment(aes(x=as.Date("2023-10-01"), y=0.0335, xend = as.Date("2024-04-01"), yend = 0.0335), arrow=arrow(length = unit(0.3, 'cm')), color='black')+#annotate(geom="text", x=as.Date("2023-03-01"), y=0.0340, size=3, label= sprintf('\u2191'))+
labs(x="Year",
y="Attendance rate",
col="NHS Board Name")
save_plot("Output/Orkney_Glasgow_predict_rates2018to2023vline.svg", fig=Orkney_Glasgow_predict_rates2018to2023, width=14, height=12)
ScotNov23 <-data.frame(Male =0.4892402, Female =0.4831486, Under18 =0.1824233, EighteentoTwentyfour =0.08412196, TwentyfivetoThirtynine =0.1833776, FortytoSixtyfour =0.2799453,  SixtyfivetoSeventyfour =0.10060757, SIMDOne =0.2573839,SIMDTwo =0.2128418, SIMDThree =0.1744787, SIMDFour =0.1546053, SIMDFive =0.1318929, Tuesday =0.1456571, Wednesday =0.1449873, Thursday =0.1390299, Friday =0.1377609, Saturday =0.1347645, Sunday =0.1395234, ED =0.8473706, Midnighttoone =0.02342818, Twotothreeam =0.01517344, Threetofouram =0.01303421, Fourtofiveam =0.012867208, Fivetosixam =0.012525249, Sixtosevenam =0.0134716, Seventoeightam =0.01639814, Eighttonineam =0.03026736, Ninetotenam =0.05104735, Tentoelevenam =0.06138565, Eleventonoon =0.06703195, Noontoonepm =0.06518696, Onetotwopm =0.0656164, Twotothreepm =0.06416109, Threetofourpm =0.06517901, Fourtofivepm =0.06414518, Fivetosixpm =0.06195028, Sixtosevenpm =0.06039954, Seventoeightpm =0.05431584, Eighttoninepm =0.05063382, Ninetotenpm =0.04506704, Tentoelevenpm =0.03786999, Eleventomidnight =0.02978226, NHSBorders =0.01947048, NHSFife =0.05778455, NHSShetland =0.005656719, NHSLanarkshire =0.1265399, NHSDumfriesandGalloway =0.03022991, NHSForthValley =0.0536222, NHSGrampian =0.07932528, NHSWesternIsles =0.005678588, NHSOrkney =0.004278987, NHSTayside =0.05844061, NHSGreaterGlasgowandClyde =0.2583648, NHSHighland =0.06884285, NHSLothian =0.1691621, Time=2131)
predict(glm_sexageSIMDdaytypehourHBTime, ScotNov23, type="response")
ScotDec23 <-data.frame(Male =0.4892402, Female =0.4831486, Under18 =0.1824233, EighteentoTwentyfour =0.08412196, TwentyfivetoThirtynine =0.1833776, FortytoSixtyfour =0.2799453,  SixtyfivetoSeventyfour =0.10060757, SIMDOne =0.2573839,SIMDTwo =0.2128418, SIMDThree =0.1744787, SIMDFour =0.1546053, SIMDFive =0.1318929, Tuesday =0.1456571, Wednesday =0.1449873, Thursday =0.1390299, Friday =0.1377609, Saturday =0.1347645, Sunday =0.1395234, ED =0.8473706, Midnighttoone =0.02342818, Twotothreeam =0.01517344, Threetofouram =0.01303421, Fourtofiveam =0.012867208, Fivetosixam =0.012525249, Sixtosevenam =0.0134716, Seventoeightam =0.01639814, Eighttonineam =0.03026736, Ninetotenam =0.05104735, Tentoelevenam =0.06138565, Eleventonoon =0.06703195, Noontoonepm =0.06518696, Onetotwopm =0.0656164, Twotothreepm =0.06416109, Threetofourpm =0.06517901, Fourtofivepm =0.06414518, Fivetosixpm =0.06195028, Sixtosevenpm =0.06039954, Seventoeightpm =0.05431584, Eighttoninepm =0.05063382, Ninetotenpm =0.04506704, Tentoelevenpm =0.03786999, Eleventomidnight =0.02978226, NHSBorders =0.01947048, NHSFife =0.05778455, NHSShetland =0.005656719, NHSLanarkshire =0.1265399, NHSDumfriesandGalloway =0.03022991, NHSForthValley =0.0536222, NHSGrampian =0.07932528, NHSWesternIsles =0.005678588, NHSOrkney =0.004278987, NHSTayside =0.05844061, NHSGreaterGlasgowandClyde =0.2583648, NHSHighland =0.06884285, NHSLothian =0.1691621, Time=2161)
predict(glm_sexageSIMDdaytypehourHBTime, ScotDec23, type="response")
ScotJan24 <-data.frame(Male =0.4892402, Female =0.4831486, Under18 =0.1824233, EighteentoTwentyfour =0.08412196, TwentyfivetoThirtynine =0.1833776, FortytoSixtyfour =0.2799453,  SixtyfivetoSeventyfour =0.10060757, SIMDOne =0.2573839,SIMDTwo =0.2128418, SIMDThree =0.1744787, SIMDFour =0.1546053, SIMDFive =0.1318929, Tuesday =0.1456571, Wednesday =0.1449873, Thursday =0.1390299, Friday =0.1377609, Saturday =0.1347645, Sunday =0.1395234, ED =0.8473706, Midnighttoone =0.02342818, Twotothreeam =0.01517344, Threetofouram =0.01303421, Fourtofiveam =0.012867208, Fivetosixam =0.012525249, Sixtosevenam =0.0134716, Seventoeightam =0.01639814, Eighttonineam =0.03026736, Ninetotenam =0.05104735, Tentoelevenam =0.06138565, Eleventonoon =0.06703195, Noontoonepm =0.06518696, Onetotwopm =0.0656164, Twotothreepm =0.06416109, Threetofourpm =0.06517901, Fourtofivepm =0.06414518, Fivetosixpm =0.06195028, Sixtosevenpm =0.06039954, Seventoeightpm =0.05431584, Eighttoninepm =0.05063382, Ninetotenpm =0.04506704, Tentoelevenpm =0.03786999, Eleventomidnight =0.02978226, NHSBorders =0.01947048, NHSFife =0.05778455, NHSShetland =0.005656719, NHSLanarkshire =0.1265399, NHSDumfriesandGalloway =0.03022991, NHSForthValley =0.0536222, NHSGrampian =0.07932528, NHSWesternIsles =0.005678588, NHSOrkney =0.004278987, NHSTayside =0.05844061, NHSGreaterGlasgowandClyde =0.2583648, NHSHighland =0.06884285, NHSLothian =0.1691621, Time=2192)
predict(glm_sexageSIMDdaytypehourHBTime, ScotJan24, type="response")
OrkneyNov23Time_attendancerate <- c(NHSBoardName = "NHS Orkney", Attendances = 595, Month = "2023-11-01", AllAges= 22731, attendancerate=0.0261757)
OrkneyDec23Time_attendancerate <- c(NHSBoardName = "NHS Orkney", Attendances = 597, Month = "2023-12-01", AllAges= 22731, attendancerate=0.0262637)
OrkneyJan24Time_attendancerate <- c(NHSBoardName = "NHS Orkney", Attendances = 599, Month = "2024-01-01", AllAges= 22731, attendancerate=0.0263517)
Orkney_rates2018to2023 <- rbind(Orkney_rates2018to2023, OrkneyNov23Time_attendancerate)
Orkney_rates2018to2023 <- rbind(Orkney_rates2018to2023, OrkneyDec23Time_attendancerate)
Orkney_rates2018to2023 <- rbind(Orkney_rates2018to2023, OrkneyJan24Time_attendancerate)
str(Orkney_rates2018to2023)
#changing attendancerate to a numeric
Orkney_rates2018to2023$attendancerate <- as.numeric(Orkney_rates2018to2023$attendancerate)
str(Orkney_rates2018to2023)
ggplot(data=Orkney_rates2018to2023, aes(x=Month, y=attendancerate))+
geom_point()+
geom_line()+
labs(x="Year",
y="Attendance rate")
GlasgowNov23Time_attendancerate <- c(NHSBoardName = "NHS Greater Glasgow & Clyde", Attendances = 35951, Month = "2023-11-01", AllAges= 1192485, attendancerate=0.0301480)
GlasgowDec23Time_attendancerate <- c(NHSBoardName = "NHS Greater Glasgow & Clyde", Attendances = 36069, Month = "2023-12-01", AllAges= 1192485, attendancerate=0.0302469)
GlasgowJan24Time_attendancerate <- c(NHSBoardName = "NHS Greater Glasgow & Clyde", Attendances = 36191, Month = "2024-01-01", AllAges= 1192485, attendancerate=0.0303492)
#Combining the dataframe containing actual rates with the prediction for Sept and Aug 2023
Glasgow_rates2018to2023 <- rbind(Glasgow_rates2018to2023, GlasgowAug23Time_attendancerate)
Glasgow_rates2018to2023 <- rbind(Glasgow_rates2018to2023, GlasgowNov23Time_attendancerate)
Glasgow_rates2018to2023 <- rbind(Glasgow_rates2018to2023, GlasgowDec23Time_attendancerate)
Glasgow_rates2018to2023 <- rbind(Glasgow_rates2018to2023, GlasgowJan24Time_attendancerate)
str(Glasgow_rates2018to2023)
#changing attendancerate to a numeric
Glasgow_rates2018to2023$attendancerate <- as.numeric(Glasgow_rates2018to2023$attendancerate)
ggplot(data=Glasgow_rates2018to2023, aes(x=Month, y=attendancerate))+
geom_point()+
geom_line()+
labs(x="Year",
y="Attendance rate")
#Orkney and Glasgow in the same graph
Orkney_Glasgow_rates2018to2023 <- rbind(Glasgow_rates2018to2023, Orkney_rates2018to2023)
ggplot(data=Orkney_Glasgow_rates2018to2023, aes(x=Month, y=attendancerate, ggroup=NHSBoardName, color=NHSBoardName))+
geom_point()+
geom_line()+
geom_vline(xintercept = as.Date("2023-08-01"), color="orange", linewidth=.5)+
annotate(geom="text", x=as.Date("2023-03-01"), y=0.0325, size=3, label="Actual")+
annotate(geom="text", x=as.Date("2024-01-01"), y=0.0325, size=3, label="Predicted")+
geom_segment(aes(x=as.Date("2023-06-01"), y=0.0335, xend = as.Date("2022-12-01"), yend = 0.0335), arrow=arrow(length = unit(0.3, 'cm')), color='black')+
geom_segment(aes(x=as.Date("2023-10-01"), y=0.0335, xend = as.Date("2024-04-01"), yend = 0.0335), arrow=arrow(length = unit(0.3, 'cm')), color='black')+#annotate(geom="text", x=as.Date("2023-03-01"), y=0.0340, size=3, label= sprintf('\u2191'))+
labs(x="Year",
y="Attendance rate",
col="NHS Board Name")
Orkney_Glasgow_predict_rates2018to2023 <- ggplot(data=Orkney_Glasgow_rates2018to2023, aes(x=Month, y=attendancerate, ggroup=NHSBoardName, color=NHSBoardName))+
geom_point()+
geom_line()+
geom_vline(xintercept = as.Date("2023-08-01"), color="orange", linewidth=.5)+
annotate(geom="text", x=as.Date("2023-03-01"), y=0.0325, size=3, label="Actual")+
annotate(geom="text", x=as.Date("2024-01-01"), y=0.0325, size=3, label="Predicted")+
geom_segment(aes(x=as.Date("2023-06-01"), y=0.0335, xend = as.Date("2022-12-01"), yend = 0.0335), arrow=arrow(length = unit(0.3, 'cm')), color='black')+
geom_segment(aes(x=as.Date("2023-10-01"), y=0.0335, xend = as.Date("2024-04-01"), yend = 0.0335), arrow=arrow(length = unit(0.3, 'cm')), color='black')+#annotate(geom="text", x=as.Date("2023-03-01"), y=0.0340, size=3, label= sprintf('\u2191'))+
labs(x="Year",
y="Attendance rate",
col="NHS Board Name")
save_plot("Output/Orkney_Glasgow_predict_rates2018to2023vline.svg", fig=Orkney_Glasgow_predict_rates2018to2023, width=14, height=12)
Orkney_Glasgow_predict_rates2018to2023 <- ggplot(data=Orkney_Glasgow_rates2018to2023, aes(x=Month, y=attendancerate, ggroup=NHSBoardName, color=NHSBoardName))+
geom_point()+
geom_line()+
geom_vline(xintercept = as.Date("2023-08-01"), color="orange", linewidth=.5)+
annotate(geom="text", x=as.Date("2023-03-01"), y=0.0325, size=3, label="Actual")+
annotate(geom="text", x=as.Date("2024-01-01"), y=0.0325, size=3, label="Predicted")+
geom_segment(aes(x=as.Date("2023-06-01"), y=0.0335, xend = as.Date("2022-12-01"), yend = 0.0335), arrow=arrow(length = unit(0.3, 'cm')), color='black')+
geom_segment(aes(x=as.Date("2023-10-01"), y=0.0335, xend = as.Date("2024-04-01"), yend = 0.0335), arrow=arrow(length = unit(0.3, 'cm')), color='black')+#annotate(geom="text", x=as.Date("2023-03-01"), y=0.0340, size=3, label= sprintf('\u2191'))+
labs(x="Year",
y="Attendance rate",
col="NHS Board Name")
save_plot("Output/Orkney_Glasgow_predict_rates2018to2023vline.svg", fig=Orkney_Glasgow_predict_rates2018to2023, width=18, height=12)
ScotNov23updatedmonth <- data.frame(Male =0.4892402, Female =0.4831486, Under18 =0.1824233, EighteentoTwentyfour =0.08412196, TwentyfivetoThirtynine =0.1833776, FortytoSixtyfour =0.2799453,  SixtyfivetoSeventyfour =0.10060757, SIMDOne =0.2573839,SIMDTwo =0.2128418, SIMDThree =0.1744787, SIMDFour =0.1546053, SIMDFive =0.1318929, Tuesday =0.1456571, Wednesday =0.1449873, Thursday =0.1390299, Friday =0.1377609, Saturday =0.1347645, Sunday =0.1395234, ED =0.8473706, Midnighttoone =0.02342818, Twotothreeam =0.01517344, Threetofouram =0.01303421, Fourtofiveam =0.012867208, Fivetosixam =0.012525249, Sixtosevenam =0.0134716, Seventoeightam =0.01639814, Eighttonineam =0.03026736, Ninetotenam =0.05104735, Tentoelevenam =0.06138565, Eleventonoon =0.06703195, Noontoonepm =0.06518696, Onetotwopm =0.0656164, Twotothreepm =0.06416109, Threetofourpm =0.06517901, Fourtofivepm =0.06414518, Fivetosixpm =0.06195028, Sixtosevenpm =0.06039954, Seventoeightpm =0.05431584, Eighttoninepm =0.05063382, Ninetotenpm =0.04506704, Tentoelevenpm =0.03786999, Eleventomidnight =0.02978226, NHSBorders =0.01947048, NHSFife =0.05778455, NHSShetland =0.005656719, NHSLanarkshire =0.1265399, NHSDumfriesandGalloway =0.03022991, NHSForthValley =0.0536222, NHSGrampian =0.07932528, NHSWesternIsles =0.005678588, NHSOrkney =0.004278987, NHSTayside =0.05844061, NHSGreaterGlasgowandClyde =0.2583648, NHSHighland =0.06884285, NHSLothian =0.1691621, Feb= 0, March=0, April=0, May=0, June=0, July=0, August=0, Sept=0, Oct=0, Nov=1, Dec=0)
predict(glm_sexageSIMDdaytypehourHBupdatedmonth, ScotNov23updatedmonth, type="response")
ScotDec23updatedmonth <- data.frame(Male =0.4892402, Female =0.4831486, Under18 =0.1824233, EighteentoTwentyfour =0.08412196, TwentyfivetoThirtynine =0.1833776, FortytoSixtyfour =0.2799453,  SixtyfivetoSeventyfour =0.10060757, SIMDOne =0.2573839,SIMDTwo =0.2128418, SIMDThree =0.1744787, SIMDFour =0.1546053, SIMDFive =0.1318929, Tuesday =0.1456571, Wednesday =0.1449873, Thursday =0.1390299, Friday =0.1377609, Saturday =0.1347645, Sunday =0.1395234, ED =0.8473706, Midnighttoone =0.02342818, Twotothreeam =0.01517344, Threetofouram =0.01303421, Fourtofiveam =0.012867208, Fivetosixam =0.012525249, Sixtosevenam =0.0134716, Seventoeightam =0.01639814, Eighttonineam =0.03026736, Ninetotenam =0.05104735, Tentoelevenam =0.06138565, Eleventonoon =0.06703195, Noontoonepm =0.06518696, Onetotwopm =0.0656164, Twotothreepm =0.06416109, Threetofourpm =0.06517901, Fourtofivepm =0.06414518, Fivetosixpm =0.06195028, Sixtosevenpm =0.06039954, Seventoeightpm =0.05431584, Eighttoninepm =0.05063382, Ninetotenpm =0.04506704, Tentoelevenpm =0.03786999, Eleventomidnight =0.02978226, NHSBorders =0.01947048, NHSFife =0.05778455, NHSShetland =0.005656719, NHSLanarkshire =0.1265399, NHSDumfriesandGalloway =0.03022991, NHSForthValley =0.0536222, NHSGrampian =0.07932528, NHSWesternIsles =0.005678588, NHSOrkney =0.004278987, NHSTayside =0.05844061, NHSGreaterGlasgowandClyde =0.2583648, NHSHighland =0.06884285, NHSLothian =0.1691621, Feb= 0, March=0, April=0, May=0, June=0, July=0, August=0, Sept=0, Oct=0, Nov=0, Dec=1)
predict(glm_sexageSIMDdaytypehourHBupdatedmonth, ScotDec23updatedmonth, type="response")
ScotJan24updatedmonth <- data.frame(Male =0.4892402, Female =0.4831486, Under18 =0.1824233, EighteentoTwentyfour =0.08412196, TwentyfivetoThirtynine =0.1833776, FortytoSixtyfour =0.2799453,  SixtyfivetoSeventyfour =0.10060757, SIMDOne =0.2573839,SIMDTwo =0.2128418, SIMDThree =0.1744787, SIMDFour =0.1546053, SIMDFive =0.1318929, Tuesday =0.1456571, Wednesday =0.1449873, Thursday =0.1390299, Friday =0.1377609, Saturday =0.1347645, Sunday =0.1395234, ED =0.8473706, Midnighttoone =0.02342818, Twotothreeam =0.01517344, Threetofouram =0.01303421, Fourtofiveam =0.012867208, Fivetosixam =0.012525249, Sixtosevenam =0.0134716, Seventoeightam =0.01639814, Eighttonineam =0.03026736, Ninetotenam =0.05104735, Tentoelevenam =0.06138565, Eleventonoon =0.06703195, Noontoonepm =0.06518696, Onetotwopm =0.0656164, Twotothreepm =0.06416109, Threetofourpm =0.06517901, Fourtofivepm =0.06414518, Fivetosixpm =0.06195028, Sixtosevenpm =0.06039954, Seventoeightpm =0.05431584, Eighttoninepm =0.05063382, Ninetotenpm =0.04506704, Tentoelevenpm =0.03786999, Eleventomidnight =0.02978226, NHSBorders =0.01947048, NHSFife =0.05778455, NHSShetland =0.005656719, NHSLanarkshire =0.1265399, NHSDumfriesandGalloway =0.03022991, NHSForthValley =0.0536222, NHSGrampian =0.07932528, NHSWesternIsles =0.005678588, NHSOrkney =0.004278987, NHSTayside =0.05844061, NHSGreaterGlasgowandClyde =0.2583648, NHSHighland =0.06884285, NHSLothian =0.1691621, Feb= 0, March=0, April=0, May=0, June=0, July=0, August=0, Sept=0, Oct=0, Nov=0, Dec=0)
predict(glm_sexageSIMDdaytypehourHBupdatedmonth, ScotJan24updatedmonth, type="response")
#Graph comparing GLM based on month, time and actual PHS values
OrkneyGlasgow_Predictvsactual_Sept23Jan24 <- read_xlsx(here("Rawdata", "2024-01-01-Orkney_Glasgow_Sept23Jan24predictions.xlxs"))
#Graph comparing GLM based on month, time and actual PHS values
OrkneyGlasgow_Predictvsactual_Sept23Jan24 <- read_xlsx(here("Rawdata", "2024-01-01-Orkney_Glasgow_Sept23Jan24predictions.xlsx"))
View(OrkneyGlasgow_Predictvsactual_Sept23Jan24)
View(OrkneyGlasgow_Predictvsactual_Sept23Jan24)
#Graph comparing GLM based on month, time and actual PHS values
OrkneyGlasgow_Predictvsactual_Sept23Jan24 <- read_xlsx(here("Rawdata", "2024-01-01-Orkney_Glasgow_Sept23Jan24predictions.xlsx"))
View(OrkneyGlasgow_Predictvsactual_Sept23Jan24)
str(OrkneyGlasgow_Predictvsactual_Sept23Jan24)
OrkneyGlasgow_Predictvsactual_Sept23Jan24$Month <- as.Date(OrkneyGlasgow_Predictvsactual_Sept23Jan24$Month)
str(OrkneyGlasgow_Predictvsactual_Sept23Jan24)
#Graph comparing GLM based on month, time and actual PHS values
OrkneyGlasgow_Predictvsactual_Sept23Jan24 <- read_xlsx(here("Rawdata", "2024-01-01-Orkney_Glasgow_Sept23Jan24predictions.xlsx"))
OrkneyGlasgow_Predictvsactual_Sept23Jan24$Month <- as.Date(OrkneyGlasgow_Predictvsactual_Sept23Jan24$Month)
str(OrkneyGlasgow_Predictvsactual_Sept23Jan24)
#Graph comparing GLM based on month, time and actual PHS values
Orkney_Predictvsactual_Aug23Jan24 <- read_xlsx(here("Rawdata", "2024-01-01-Orkney_Aug23Jan24predictions.xlsx"))
View(Orkney_Predictvsactual_Aug23Jan24)
str(Orkney_Predictvsactual_Aug23Jan24)
Orkney_Predictvsactual_Aug23Jan24$Month <- as.Date(Orkney_Predictvsactual_Aug23Jan24$Month)
str(Orkney_Predictvsactual_Aug23Jan24)
ggplot(data=Orkney_Predictvsactual_Aug23Jan24, aes(x=Month, y=Attendances, ggroup=Model, color=Model))+
geom_line()+
labs(x="Month",
y="Attendances",
col="Key")
Orkney_Predictvsactual_Aug23toJan24 <- ggplot(data=Orkney_Predictvsactual_Aug23Jan24, aes(x=Month, y=Attendances, ggroup=Model, color=Model))+
geom_line()+
labs(x="Month",
y="Attendances",
col="Key")
save_plot("Output/Orkney_predictvsactual_Aug23Jan24.svg", fig=Orkney_Predictvsactual_Aug23toJan24, width=14, height=12)
Orkney_Predictvsactual_Aug23toJan24 <- ggplot(data=Orkney_Predictvsactual_Aug23Jan24, aes(x=Month, y=Attendances, ggroup=Model, color=Model))+
geom_line()+
labs(x="Month",
y="Attendances",
col="Key")
save_plot("Output/Orkney_predictvsactual_Aug23Jan24.svg", fig=Orkney_Predictvsactual_Aug23toJan24, width=14, height=12)
#Glasgow graph comparing GLM based on month, time and actual PHS values
Glasgow_Predictvsactual_Aug23Jan24 <- read_xlsx(here("Rawdata", "2024-01-01-Glasgow_Aug23Jan24predictions.xlsx"))
Glasgow_Predictvsactual_Aug23Jan24$Month <- as.Date(Glasgow_Predictvsactual_Aug23Jan24$Month)
str(Glasgow_Predictvsactual_Aug23Jan24)
ggplot(data=Glasgow_Predictvsactual_Aug23Jan24, aes(x=Month, y=Attendances, ggroup=Model, color=Model))+
geom_line()+
labs(x="Month",
y="Attendances",
col="Key")
Glasgow_Predictvsactual_Aug23toJan24 <- ggplot(data=Glasgow_Predictvsactual_Aug23Jan24, aes(x=Month, y=Attendances, ggroup=Model, color=Model))+
geom_line()+
labs(x="Month",
y="Attendances",
col="Key")
save_plot("Output/Glasgow_predictvsactual_Aug23Jan24.svg", fig=Glasgow_Predictvsactual_Aug23toJan24, width=14, height=12)
Glasgow_Predictvsactual_Aug23toJan24 <- ggplot(data=Glasgow_Predictvsactual_Aug23Jan24, aes(x=Month, y=Attendances, ggroup=Model, color=Model))+
geom_line()+
labs(x="Month",
y="Attendances",
col="Key")
save_plot("Output/Glasgow_predictvsactual_Aug23Jan24.svg", fig=Glasgow_Predictvsactual_Aug23toJan24, width=14, height=12)
ggplot(data=Orkney_Predictvsactual_Aug23Jan24, aes(x=Month, y=Attendances, ggroup=Model, color=Model))+
geom_line()+
labs(x="Month",
y="Attendances",
col="Key")+
theme(legend.position = "bottom")
ggplot(data=Orkney_Predictvsactual_Aug23Jan24, aes(x=Month, y=Attendances, ggroup=Model, color=Model))+
geom_line()+
labs(x="Month",
y="Attendances")+
theme(legend.position = "bottom")
ggplot(data=Orkney_Predictvsactual_Aug23Jan24, aes(x=Month, y=Attendances, ggroup=Model, color=Model))+
geom_line()+
labs(x="Month",
y="Attendances",
col="Key")+
theme(legend.position = "bottom")
ggplot(data=Orkney_Predictvsactual_Aug23Jan24, aes(x=Month, y=Attendances, ggroup=Model, color=Model))+
geom_line()+
labs(x="Month",
y="Attendances",
col="Key:")+
theme(legend.position = "bottom")
Orkney_Predictvsactual_Aug23toJan24 <- ggplot(data=Orkney_Predictvsactual_Aug23Jan24, aes(x=Month, y=Attendances, ggroup=Model, color=Model))+
geom_line()+
labs(x="Month",
y="Attendances",
col="Key:")+
theme(legend.position = "bottom")
save_plot("Output/Orkney_predictvsactual_Aug23Jan24.svg", fig=Orkney_Predictvsactual_Aug23toJan24, width=12, height=12)
ggplot(data=Glasgow_Predictvsactual_Aug23Jan24, aes(x=Month, y=Attendances, ggroup=Model, color=Model))+
geom_line()+
labs(x="Month",
y="Attendances",
col="Key:")+
theme(legend.position = "bottom")
Glasgow_Predictvsactual_Aug23toJan24 <- ggplot(data=Glasgow_Predictvsactual_Aug23Jan24, aes(x=Month, y=Attendances, ggroup=Model, color=Model))+
geom_line()+
labs(x="Month",
y="Attendances",
col="Key:")+
theme(legend.position = "bottom")
save_plot("Output/Glasgow_predictvsactual_Aug23Jan24.svg", fig=Glasgow_Predictvsactual_Aug23toJan24, width=14, height=12)
Glasgow_Predictvsactual_Aug23toJan24 <- ggplot(data=Glasgow_Predictvsactual_Aug23Jan24, aes(x=Month, y=Attendances, ggroup=Model, color=Model))+
geom_line()+
labs(x="Month",
y="Attendances",
col="Key:")+
theme(legend.position = "bottom")
save_plot("Output/Glasgow_predictvsactual_Aug23Jan24.svg", fig=Glasgow_Predictvsactual_Aug23toJan24, width=12, height=12)
ggplot(data = agegroupScotED, aes(x= Month, y= `Rate/100,000`, group= Age, color= Age)) +
geom_line() +
labs(
#title = "Attendance rate per 100,000 in Scottish emergency departments \nby age group",
x = "Year",
y = "Attendance rate per 100,000")+
theme(legend.position = "bottom")
ggplot(data = agegroupScotED, aes(x= Month, y= `Rate/100,000`, group= Age, color= Age)) +
geom_line() +
labs(
#title = "Attendance rate per 100,000 in Scottish emergency departments \nby age group",
x = "Year",
y = "Attendance rate per 100,000")+
theme(legend.position = "bottom")
Scot_ED_attendancerate_agegroup_legendbottom <- ggplot(data = agegroupScotED, aes(x= Month, y= `Rate/100,000`, group= Age, color= Age)) +
geom_line() +
labs(
#title = "Attendance rate per 100,000 in Scottish emergency departments \nby age group",
x = "Year",
y = "Attendance rate per 100,000")+
theme(legend.position = "bottom")
save_plot("Output/Scot_ED_attendancerate_agegroup_legendbottom.svg", fig = Scot_ED_attendancerate_agegroup, width = 12, height = 14)
Scot_ED_attendancerate_agegroup_legendbottom <- ggplot(data = agegroupScotED, aes(x= Month, y= `Rate/100,000`, group= Age, color= Age)) +
geom_line() +
labs(
#title = "Attendance rate per 100,000 in Scottish emergency departments \nby age group",
x = "Year",
y = "Attendance rate per 100,000")+
theme(legend.position = "bottom")
save_plot("Output/Scot_ED_attendancerate_agegroup_legendbottom.svg", fig = Scot_ED_attendancerate_agegroup_legendbottom, width = 12, height = 14)
ggplot(data = agegroupScotED, aes(x= Month, y= `Rate/100,000`, group= Age, color= Age)) +
geom_line() +
labs(
#title = "Attendance rate per 100,000 in Scottish emergency departments \nby age group",
x = "Year",
y = "Attendance rate per 100,000")+
theme(legend.position = "bottom", legend.text=element_text(size=3))
ggplot(data = agegroupScotED, aes(x= Month, y= `Rate/100,000`, group= Age, color= Age)) +
geom_line() +
labs(
#title = "Attendance rate per 100,000 in Scottish emergency departments \nby age group",
x = "Year",
y = "Attendance rate per 100,000")+
theme(legend.position = "bottom", legend.text=element_text(size=10))
ggplot(data = agegroupScotED, aes(x= Month, y= `Rate/100,000`, group= Age, color= Age)) +
geom_line() +
labs(
#title = "Attendance rate per 100,000 in Scottish emergency departments \nby age group",
x = "Year",
y = "Attendance rate per 100,000")+
theme(legend.position = "bottom", legend.text=element_text(size=9))
ggplot(data = agegroupScotED, aes(x= Month, y= `Rate/100,000`, group= Age, color= Age)) +
geom_line() +
labs(
#title = "Attendance rate per 100,000 in Scottish emergency departments \nby age group",
x = "Year",
y = "Attendance rate per 100,000")+
theme(legend.position = "bottom", text=element_text(size=9))
ggplot(data = agegroupScotED, aes(x= Month, y= `Rate/100,000`, group= Age, color= Age)) +
geom_line() +
theme(legend.position = "bottom", text=element_text(size=10))+
labs(
#title = "Attendance rate per 100,000 in Scottish emergency departments \nby age group",
x = "Year",
y = "Attendance rate per 100,000")
ggplot(data = agegroupScotED, aes(x= Month, y= `Rate/100,000`, group= Age, color= Age)) +
geom_line() +
theme(legend.position = "bottom", text=element_text(size=12))+
labs(
#title = "Attendance rate per 100,000 in Scottish emergency departments \nby age group",
x = "Year",
y = "Attendance rate per 100,000")
ggplot(data = agegroupScotED, aes(x= Month, y= `Rate/100,000`, group= Age, color= Age)) +
geom_line() +
theme(legend.position = "bottom", text=element_text(size=12), legend.text=element_text(size=12))+
labs(
#title = "Attendance rate per 100,000 in Scottish emergency departments \nby age group",
x = "Year",
y = "Attendance rate per 100,000")
ggplot(data = agegroupScotED, aes(x= Month, y= `Rate/100,000`, group= Age, color= Age)) +
geom_line() +
theme(legend.position = "bottom", text=element_text(size=12), legend.text=element_text(size=10))+
labs(
#title = "Attendance rate per 100,000 in Scottish emergency departments \nby age group",
x = "Year",
y = "Attendance rate per 100,000")
Scot_ED_attendancerate_agegroup_legendbottom <- ggplot(data = agegroupScotED, aes(x= Month, y= `Rate/100,000`, group= Age, color= Age)) +
geom_line() +
theme(legend.position = "bottom", text=element_text(size=12), legend.text=element_text(size=10))+
labs(
#title = "Attendance rate per 100,000 in Scottish emergency departments \nby age group",
x = "Year",
y = "Attendance rate per 100,000")
save_plot("Output/Scot_ED_attendancerate_agegroup_legendbottom.svg", fig = Scot_ED_attendancerate_agegroup_legendbottom, width = 12, height = 14)
ggplot(data = agegroupScotED, aes(x= Month, y= `Rate/100,000`, group= Age, color= Age)) +
geom_line() +
theme(axis.text.x = element_text(size=10),
axis.text.y = element_text(size=10),
axis.title.x = element_text(size=10),
axis.title.y = element_text(size=10),
legend.position = "bottom", legend.text=element_text(size=10))+
labs(
#title = "Attendance rate per 100,000 in Scottish emergency departments \nby age group",
x = "Year",
y = "Attendance rate per 100,000")
Scot_ED_attendancerate_agegroup_legendbottom <- ggplot(data = agegroupScotED, aes(x= Month, y= `Rate/100,000`, group= Age, color= Age)) +
geom_line() +
theme(axis.text.x = element_text(size=10),
axis.text.y = element_text(size=10),
axis.title.x = element_text(size=10),
axis.title.y = element_text(size=10),
legend.position = "bottom", legend.text=element_text(size=10))+
labs(
#title = "Attendance rate per 100,000 in Scottish emergency departments \nby age group",
x = "Year",
y = "Attendance rate per 100,000")
save_plot("Output/Scot_ED_attendancerate_agegroup_legendbottom.svg", fig = Scot_ED_attendancerate_agegroup_legendbottom, width = 12, height = 14)
ggplot(data = agegroupScotMIUOther, aes(x= Month, y= `Rate/100,000`, group= Age, color= Age)) +
geom_line() +
theme(axis.text.x = element_text(size=10),
axis.text.y = element_text(size=10),
axis.title.x = element_text(size=10),
axis.title.y = element_text(size=10),
legend.position = "bottom", legend.text=element_text(size=10))+
labs(
#title = "Attendance rate per 100,000 in Scottish MIU/Other by age group",
x = "Year",
y = "Attendance rate per 100,000")
Scot_MIUOther_attendancerate_agegroup_legendbottom <- ggplot(data = agegroupScotMIUOther, aes(x= Month, y= `Rate/100,000`, group= Age, color= Age)) +
geom_line() +
theme(axis.text.x = element_text(size=10),
axis.text.y = element_text(size=10),
axis.title.x = element_text(size=10),
axis.title.y = element_text(size=10),
legend.position = "bottom", legend.text=element_text(size=10))+
labs(
#title = "Attendance rate per 100,000 in Scottish MIU/Other by age group",
x = "Year",
y = "Attendance rate per 100,000")
save_plot("Output/Scot_MIUOther_attendancerate_agegroup_legendbottom.svg", fig = Scot_MIUOther_attendancerate_agegroup_legendbottom, width = 12, height = 14)
ggplot(data = agegroupScotMIUOther, aes(x= Month, y= `Rate/100,000`, group= Age, color= Age)) +
geom_line() +
theme(axis.text.x = element_text(size=10),
axis.text.y = element_text(size=10),
axis.title.x = element_text(size=10),
axis.title.y = element_text(size=12),
legend.position = "bottom", legend.text=element_text(size=10))+
labs(
#title = "Attendance rate per 100,000 in Scottish MIU/Other by age group",
x = "Year",
y = "Attendance rate per 100,000")
Scot_MIUOther_attendancerate_agegroup_legendbottom <- ggplot(data = agegroupScotMIUOther, aes(x= Month, y= `Rate/100,000`, group= Age, color= Age)) +
geom_line() +
theme(axis.text.x = element_text(size=10),
axis.text.y = element_text(size=10),
axis.title.x = element_text(size=10),
axis.title.y = element_text(size=12),
legend.position = "bottom", legend.text=element_text(size=10))+
labs(
#title = "Attendance rate per 100,000 in Scottish MIU/Other by age group",
x = "Year",
y = "Attendance rate per 100,000")
save_plot("Output/Scot_MIUOther_attendancerate_agegroup_legendbottom.svg", fig = Scot_MIUOther_attendancerate_agegroup_legendbottom, width = 12, height = 14)
Scot_MIUOther_attendancerate_agegroup_legendbottom <- ggplot(data = agegroupScotMIUOther, aes(x= Month, y= `Rate/100,000`, group= Age, color= Age)) +
geom_line() +
theme(axis.text.x = element_text(size=12),
axis.text.y = element_text(size=12),
axis.title.x = element_text(size=12),
axis.title.y = element_text(size=12),
legend.position = "bottom", legend.text=element_text(size=10))+
labs(
#title = "Attendance rate per 100,000 in Scottish MIU/Other by age group",
x = "Year",
y = "Attendance rate per 100,000")
save_plot("Output/Scot_MIUOther_attendancerate_agegroup_legendbottom.svg", fig = Scot_MIUOther_attendancerate_agegroup_legendbottom, width = 12, height = 14)
Scot_ED_attendancerate_agegroup_legendbottom <- ggplot(data = agegroupScotED, aes(x= Month, y= `Rate/100,000`, group= Age, color= Age)) +
geom_line() +
theme(axis.text.x = element_text(size=12),
axis.text.y = element_text(size=12),
axis.title.x = element_text(size=12),
axis.title.y = element_text(size=12),
legend.position = "bottom", legend.text=element_text(size=10))+
labs(
#title = "Attendance rate per 100,000 in Scottish emergency departments \nby age group",
x = "Year",
y = "Attendance rate per 100,000")
save_plot("Output/Scot_ED_attendancerate_agegroup_legendbottom.svg", fig = Scot_ED_attendancerate_agegroup_legendbottom, width = 12, height = 14)
ggplot(data = agegroupScotAE, aes(x= Month, y= `Rate/100,000`, group= Age, color= Age)) +
geom_line() +
theme(axis.text.x = element_text(size=12),
axis.text.y = element_text(size=12),
axis.title.x = element_text(size=12),
axis.title.y = element_text(size=12),
legend.position = "bottom", legend.text=element_text(size=10))+
labs(
#title = "Attendance rate per 100,000 in Scottish A&E by age group",
x = "Year",
y = "Attendance rate per 100,000")
Scot_AE_attendancerate_agegroup_legendbottom <- ggplot(data = agegroupScotAE, aes(x= Month, y= `Rate/100,000`, group= Age, color= Age)) +
geom_line() +
theme(axis.text.x = element_text(size=12),
axis.text.y = element_text(size=12),
axis.title.x = element_text(size=12),
axis.title.y = element_text(size=12),
legend.position = "bottom", legend.text=element_text(size=10))+
labs(
#title = "Attendance rate per 100,000 in Scottish A&E by age group",
x = "Year",
y = "Attendance rate per 100,000")
save_plot("Output/Scot_AE_attendancerate_agegroup_legendbottom.svg", fig = Scot_AE_attendancerate_agegroup_legendbottom, width = 12, height = 14)
ggplot(data = agegroupScotAE, aes(x= Month, y= `Rate/100,000`, group= Age, color= Age)) +
geom_line() +
theme(axis.text.x = element_text(size=12),
axis.text.y = element_text(size=12),
axis.title.x = element_text(size=12),
axis.title.y = element_text(size=12),
legend.position = "bottom", legend.text=element_text(size=10))+
labs(
#title = "Attendance rate per 100,000 in Scottish A&E by age group",
x = "Year",
y = "Attendance rate per 100,000",
col="Age")
