View(Neteffect_daydiff)
#Combine original Neteffect_day dataframe to contain the proportion differences
Neteffect_day <- cbind(Neteffect_day, Neteffect_daydiff)
View(Neteffect_day)
#Calculate diff for each day. Then times the coefficient. Then add it and then overall exponentiation.
#Calculating the coefficient times proportion for each day
Mondaycoeff <- 1.244
Neteffect_day$coeffpropMonday <-  Neteffect_day$Mondaydiff*Mondaycoeff
Tuesdaycoeff <- -0.6717
Neteffect_day$coeffpropTuesday <-  Neteffect_day$Tuesdaydiff*Tuesdaycoeff
Wednesdaycoeff <- 0.8354
Neteffect_day$coeffpropWednesday <-  Neteffect_day$Wednesdaydiff*Wednesdaycoeff
Thursdaycoeff <- 0.3252
Neteffect_day$coeffpropThursday <-  Neteffect_day$Thursdaydiff*Thursdaycoeff
Fridaycoeff <- 0.3131
Neteffect_day$coeffpropFriday <-  Neteffect_day$Fridaydiff*Fridaycoeff
Saturdaycoeff <- -0.3669
Neteffect_day$coeffpropSaturday <-  Neteffect_day$Saturdaydiff*Saturdaycoeff
#sum of the coefficient times proportion for all days of the week
Neteffect_day$coeffpropallday <- Neteffect_day$coeffpropMonday + Neteffect_day$coeffpropTuesday + Neteffect_day$coeffpropWednesday + Neteffect_day$coeffpropThursday + Neteffect_day$coeffpropFriday + Neteffect_day$coeffpropSaturday
#exponentiating the sum of the coefficient times proportion for day
Neteffect_day$expcoeffpropallday <- exp(Neteffect_day$coeffpropallday)
ggplot(data=Neteffect_day, aes(x=date, y=expcoeffpropallday))+
geom_line()+
labs(title="Net effect of day of the week on total attendances over time",
x = "Date",
y = "Net effect on attendances")
Neteffect_day_plot <- ggplot(data=Neteffect_day, aes(x=date, y=expcoeffpropallday))+
geom_line()+
labs(title="Net effect of day of the week on total attendances over time",
x = "Date",
y = "Net effect on attendances")
save_plot("Output/Neteffect_day_plot.svg", fig=Neteffect_day_plot, width=14, height=12)
ggplot(data=Covid_monthlyae_activity_timeline, aes(x=date, y=NumberOfAttendancesAll))+
geom_point()+
geom_line(size=1,colour="black")+
geom_label(aes(label= ("1 Lockdown \n 2 Tightening \n 3 Easing \n 4 Removed"),x=as.Date("2018-11-01"), y=90000))+
#legend("bottomleft", inset=0.2, title="Restrictions", c("1 Lockdown", "2 Tightening", "3 Easing", "4 No restrictions"), col=c("#FF0033", "#FF00CC", "#9966FF", "#00FFFF", lty=1:2, cex=0.8)) +
geom_rect(aes(xmin = as.Date("2018-01-01"), xmax = as.Date("2020-03-31"), ymin=-Inf, ymax=Inf), fill="#00FFFF", alpha=.01) + #4
#annotate(geom="text", x=as.Date("2019-02-28"), color="black", y=60100, size=3, label="4")+
geom_rect(aes(xmin = as.Date("2020-04-01"), xmax = as.Date("2020-05-31"), ymin=-Inf, ymax=Inf), fill="#FF0033", alpha=.01) + #1
#annotate(geom="text", x=as.Date("2020-04-30"), color="black", y=60100, size=3, label="1")+
geom_rect(aes(xmin = as.Date("2020-06-01"), xmax = as.Date("2020-09-30"), ymin=-Inf, ymax=Inf), fill="#9966FF", alpha=.01) + #3
#annotate(geom="text", x=as.Date("2020-07-30"), color="black", y=60100, size=3, label="3")+
geom_rect(aes(xmin = as.Date("2020-10-01"), xmax = as.Date("2020-12-31"), ymin=-Inf, ymax=Inf), fill="#FF00CC", alpha=.01) + #2
#annotate(geom="text", x=as.Date("2020-11-15"), color="black", y=60100, size=3, label="2")+
geom_rect(aes(xmin = as.Date("2021-01-01"), xmax = as.Date("2021-04-30"), ymin=-Inf, ymax=Inf), fill="#FF0033", alpha=.01) + #1
#annotate(geom="text", x=as.Date("2021-03-01"), color="black", y=60100, size=3, label="1")+
geom_rect(aes(xmin = as.Date("2021-05-01"), xmax = as.Date("2021-07-31"), ymin=-Inf, ymax=Inf), fill="#9966FF", alpha=.01) + #3
#annotate(geom="text", x=as.Date("2021-06-15"), color="black", y=60100, size=3, label="3")+
geom_rect(aes(xmin = as.Date("2021-08-01"), xmax = as.Date("2022-12-31"), ymin=-Inf, ymax=Inf), fill="#00FFFF", alpha=.01) + #4
#annotate(geom="text", x=as.Date("2022-04-01"), color="black", y=60100, size=3, label="4")+
labs(x= "Date",
y = "Total number of Scottish A&E attendances")
library(tidyverse)
library(here)
library(readxl)
library(dplyr)
library(ggplot2)
library(lubridate)
library(sf)
library(scales)
library(sjPlot)
ggplot(data=Covid_monthlyae_activity_timeline, aes(x=date, y=NumberOfAttendancesAll))+
geom_point()+
geom_line(size=1,colour="black")+
geom_rect(aes(xmin = as.Date("2018-01-01"), xmax = as.Date("2020-03-23"), ymin=-Inf, ymax=Inf), fill="#00FFFF", alpha=.01) +
geom_rect(aes(xmin = as.Date("2020-03-23"), xmax = as.Date("2020-05-29"), ymin=-Inf, ymax=Inf), fill="#FF0033", alpha=.01) + #UKlockdown
geom_rect(aes(xmin = as.Date("2020-05-29"), xmax = as.Date("2020-06-19"), ymin=-Inf, ymax=Inf), fill="#FF0099", alpha=.01) + #Phase 1
geom_rect(aes(xmin = as.Date("2020-06-19"), xmax = as.Date("2020-07-10"), ymin=-Inf, ymax=Inf), fill="#CC33CC", alpha=.01) + #Phase2
geom_rect(aes(xmin = as.Date("2020-07-10"), xmax = as.Date("2020-09-23"), ymin=-Inf, ymax=Inf), fill="#CC66FF", alpha=.01) + #Phase3
geom_rect(aes(xmin = as.Date("2020-09-23"), xmax = as.Date("2021-01-05"), ymin=-Inf, ymax=Inf), fill="#FF00CC", alpha=.01) + #Scottish restrictions
geom_rect(aes(xmin = as.Date("2021-01-05"), xmax = as.Date("2021-04-02"), ymin=-Inf, ymax=Inf), fill="#FF0033", alpha=.01) + #Scottish mainland lockdown
geom_rect(aes(xmin = as.Date("2021-04-02"), xmax = as.Date("2021-04-26"), ymin=-Inf, ymax=Inf), fill="#FF00CC", alpha=.01) + #Stay home to stay local
geom_rect(aes(xmin = as.Date("2021-04-26"), xmax = as.Date("2021-05-17"), ymin=-Inf, ymax=Inf), fill="#CC66FF", alpha=.01) + #Level 3
geom_rect(aes(xmin = as.Date("2021-05-17"), xmax = as.Date("2021-06-05"), ymin=-Inf, ymax=Inf), fill="#9966FF", alpha=.01) + #Level 2
geom_rect(aes(xmin = as.Date("2021-06-05"), xmax = as.Date("2021-07-19"), ymin=-Inf, ymax=Inf), fill="#9999FF", alpha=.01) + #Most mainland level 1
geom_rect(aes(xmin = as.Date("2021-07-19"), xmax = as.Date("2021-08-09"), ymin=-Inf, ymax=Inf), fill="#66CCFF", alpha=.01) + #Level 0
geom_rect(aes(xmin = as.Date("2021-08-09"), xmax = as.Date("2022-12-31"), ymin=-Inf, ymax=Inf), fill="#00FFFF", alpha=.01) + #Beyond level 0
#theme_classic()+
labs(x= "Date",
y = "Total number of Scottish A&E attendances")
ggplot(data=Covid_monthlyae_activity_timeline, aes(x=date, y=NumberOfAttendancesAll))+
geom_point()+
geom_line(size=1,colour="black")+
geom_label(aes(label= ("1 Lockdown \n 2 Tightening \n 3 Easing \n 4 Removed"),x=as.Date("2018-11-01"), y=90000))+
#legend("bottomleft", inset=0.2, title="Restrictions", c("1 Lockdown", "2 Tightening", "3 Easing", "4 No restrictions"), col=c("#FF0033", "#FF00CC", "#9966FF", "#00FFFF", lty=1:2, cex=0.8)) +
geom_rect(aes(xmin = as.Date("2018-01-01"), xmax = as.Date("2020-03-31"), ymin=-Inf, ymax=Inf), fill="#00FFFF", alpha=.01) + #4
#annotate(geom="text", x=as.Date("2019-02-28"), color="black", y=60100, size=3, label="4")+
geom_rect(aes(xmin = as.Date("2020-04-01"), xmax = as.Date("2020-05-31"), ymin=-Inf, ymax=Inf), fill="#FF0033", alpha=.01) + #1
#annotate(geom="text", x=as.Date("2020-04-30"), color="black", y=60100, size=3, label="1")+
geom_rect(aes(xmin = as.Date("2020-06-01"), xmax = as.Date("2020-09-30"), ymin=-Inf, ymax=Inf), fill="#9966FF", alpha=.01) + #3
#annotate(geom="text", x=as.Date("2020-07-30"), color="black", y=60100, size=3, label="3")+
geom_rect(aes(xmin = as.Date("2020-10-01"), xmax = as.Date("2020-12-31"), ymin=-Inf, ymax=Inf), fill="#FF00CC", alpha=.01) + #2
#annotate(geom="text", x=as.Date("2020-11-15"), color="black", y=60100, size=3, label="2")+
geom_rect(aes(xmin = as.Date("2021-01-01"), xmax = as.Date("2021-04-30"), ymin=-Inf, ymax=Inf), fill="#FF0033", alpha=.01) + #1
#annotate(geom="text", x=as.Date("2021-03-01"), color="black", y=60100, size=3, label="1")+
geom_rect(aes(xmin = as.Date("2021-05-01"), xmax = as.Date("2021-07-31"), ymin=-Inf, ymax=Inf), fill="#9966FF", alpha=.01) + #3
#annotate(geom="text", x=as.Date("2021-06-15"), color="black", y=60100, size=3, label="3")+
geom_rect(aes(xmin = as.Date("2021-08-01"), xmax = as.Date("2022-12-31"), ymin=-Inf, ymax=Inf), fill="#00FFFF", alpha=.01) + #4
#annotate(geom="text", x=as.Date("2022-04-01"), color="black", y=60100, size=3, label="4")+
labs(x= "Date",
y = "Total number of Scottish A&E attendances")
ggplot(data=Covid_monthlyae_activity_timeline, aes(x=date, y=NumberOfAttendancesAll))+
geom_point()+
geom_line(size=1,colour="black")+
geom_label(aes(label= ("1 Lockdown \n 2 Tightening \n 3 Easing \n 4 Removed"),x=as.Date("2018-11-01"), y=90000))+
#legend("bottomleft", inset=0.2, title="Restrictions", c("1 Lockdown", "2 Tightening", "3 Easing", "4 No restrictions"), col=c("#FF0033", "#FF00CC", "#9966FF", "#00FFFF", lty=1:2, cex=0.8)) +
geom_rect(aes(xmin = as.Date("2018-01-01"), xmax = as.Date("2020-03-31"), ymin=-Inf, ymax=Inf), fill="#00FFFF", alpha=.01) + #4
#annotate(geom="text", x=as.Date("2019-02-28"), color="black", y=60100, size=3, label="4")+
geom_rect(aes(xmin = as.Date("2020-04-01"), xmax = as.Date("2020-05-31"), ymin=-Inf, ymax=Inf), fill="#FF0033", alpha=.01) + #1
#annotate(geom="text", x=as.Date("2020-04-30"), color="black", y=60100, size=3, label="1")+
geom_rect(aes(xmin = as.Date("2020-06-01"), xmax = as.Date("2020-09-30"), ymin=-Inf, ymax=Inf), fill="#9900FF", alpha=.01) + #3
#annotate(geom="text", x=as.Date("2020-07-30"), color="black", y=60100, size=3, label="3")+
geom_rect(aes(xmin = as.Date("2020-10-01"), xmax = as.Date("2020-12-31"), ymin=-Inf, ymax=Inf), fill="#FF00CC", alpha=.01) + #2
#annotate(geom="text", x=as.Date("2020-11-15"), color="black", y=60100, size=3, label="2")+
geom_rect(aes(xmin = as.Date("2021-01-01"), xmax = as.Date("2021-04-30"), ymin=-Inf, ymax=Inf), fill="#FF0033", alpha=.01) + #1
#annotate(geom="text", x=as.Date("2021-03-01"), color="black", y=60100, size=3, label="1")+
geom_rect(aes(xmin = as.Date("2021-05-01"), xmax = as.Date("2021-07-31"), ymin=-Inf, ymax=Inf), fill="#9900FF", alpha=.01) + #3
#annotate(geom="text", x=as.Date("2021-06-15"), color="black", y=60100, size=3, label="3")+
geom_rect(aes(xmin = as.Date("2021-08-01"), xmax = as.Date("2022-12-31"), ymin=-Inf, ymax=Inf), fill="#00FFFF", alpha=.01) + #4
#annotate(geom="text", x=as.Date("2022-04-01"), color="black", y=60100, size=3, label="4")+
labs(x= "Date",
y = "Total number of Scottish A&E attendances")
Covid_aeScotlandactivity_encodingtimeline2018to2022<- ggplot(data=Covid_monthlyae_activity_timeline, aes(x=date, y=NumberOfAttendancesAll))+
geom_point()+
geom_line(size=1,colour="black")+
geom_label(aes(label= ("1 Lockdown \n 2 Tightening \n 3 Easing \n 4 Removed"),x=as.Date("2018-11-01"), y=90000))+
#legend("bottomleft", inset=0.2, title="Restrictions", c("1 Lockdown", "2 Tightening", "3 Easing", "4 No restrictions"), col=c("#FF0033", "#FF00CC", "#9966FF", "#00FFFF", lty=1:2, cex=0.8)) +
geom_rect(aes(xmin = as.Date("2018-01-01"), xmax = as.Date("2020-03-31"), ymin=-Inf, ymax=Inf), fill="#00FFFF", alpha=.01) + #4
#annotate(geom="text", x=as.Date("2019-02-28"), color="black", y=60100, size=3, label="4")+
geom_rect(aes(xmin = as.Date("2020-04-01"), xmax = as.Date("2020-05-31"), ymin=-Inf, ymax=Inf), fill="#FF0033", alpha=.01) + #1
#annotate(geom="text", x=as.Date("2020-04-30"), color="black", y=60100, size=3, label="1")+
geom_rect(aes(xmin = as.Date("2020-06-01"), xmax = as.Date("2020-09-30"), ymin=-Inf, ymax=Inf), fill="#9900FF", alpha=.01) + #3
#annotate(geom="text", x=as.Date("2020-07-30"), color="black", y=60100, size=3, label="3")+
geom_rect(aes(xmin = as.Date("2020-10-01"), xmax = as.Date("2020-12-31"), ymin=-Inf, ymax=Inf), fill="#FF00CC", alpha=.01) + #2
#annotate(geom="text", x=as.Date("2020-11-15"), color="black", y=60100, size=3, label="2")+
geom_rect(aes(xmin = as.Date("2021-01-01"), xmax = as.Date("2021-04-30"), ymin=-Inf, ymax=Inf), fill="#FF0033", alpha=.01) + #1
#annotate(geom="text", x=as.Date("2021-03-01"), color="black", y=60100, size=3, label="1")+
geom_rect(aes(xmin = as.Date("2021-05-01"), xmax = as.Date("2021-07-31"), ymin=-Inf, ymax=Inf), fill="#9900FF", alpha=.01) + #3
#annotate(geom="text", x=as.Date("2021-06-15"), color="black", y=60100, size=3, label="3")+
geom_rect(aes(xmin = as.Date("2021-08-01"), xmax = as.Date("2022-12-31"), ymin=-Inf, ymax=Inf), fill="#00FFFF", alpha=.01) + #4
#annotate(geom="text", x=as.Date("2022-04-01"), color="black", y=60100, size=3, label="4")+
labs(x= "Date",
y = "Total number of Scottish A&E attendances")
save_plot("Output/Covid_aeScotlandactivity_encodingtimeline2018to2022.svg", fig=Covid_aeScotlandactivity_encodingtimeline2018to2022, width=14, height=12)
ggplot(data=Covid_monthlyae_activity_timeline, aes(x=date, y=NumberOfAttendancesAll))+
geom_point()+
geom_line(size=1,colour="black")+
geom_label(aes(label= ("1 Lockdown \n 2 Tightening \n 3 Easing \n 4 No restriction"),x=as.Date("2018-11-01"), y=90000))+
#legend("bottomleft", inset=0.2, title="Restrictions", c("1 Lockdown", "2 Tightening", "3 Easing", "4 No restrictions"), col=c("#FF0033", "#FF00CC", "#9966FF", "#00FFFF", lty=1:2, cex=0.8)) +
geom_rect(aes(xmin = as.Date("2018-01-01"), xmax = as.Date("2020-03-31"), ymin=-Inf, ymax=Inf), fill="#00FFFF", alpha=.01) + #4
#annotate(geom="text", x=as.Date("2019-02-28"), color="black", y=60100, size=3, label="4")+
geom_rect(aes(xmin = as.Date("2020-04-01"), xmax = as.Date("2020-05-31"), ymin=-Inf, ymax=Inf), fill="#FF0033", alpha=.01) + #1
#annotate(geom="text", x=as.Date("2020-04-30"), color="black", y=60100, size=3, label="1")+
geom_rect(aes(xmin = as.Date("2020-06-01"), xmax = as.Date("2020-09-30"), ymin=-Inf, ymax=Inf), fill="#9900FF", alpha=.01) + #3
#annotate(geom="text", x=as.Date("2020-07-30"), color="black", y=60100, size=3, label="3")+
geom_rect(aes(xmin = as.Date("2020-10-01"), xmax = as.Date("2020-12-31"), ymin=-Inf, ymax=Inf), fill="#FF00CC", alpha=.01) + #2
#annotate(geom="text", x=as.Date("2020-11-15"), color="black", y=60100, size=3, label="2")+
geom_rect(aes(xmin = as.Date("2021-01-01"), xmax = as.Date("2021-04-30"), ymin=-Inf, ymax=Inf), fill="#FF0033", alpha=.01) + #1
#annotate(geom="text", x=as.Date("2021-03-01"), color="black", y=60100, size=3, label="1")+
geom_rect(aes(xmin = as.Date("2021-05-01"), xmax = as.Date("2021-07-31"), ymin=-Inf, ymax=Inf), fill="#9900FF", alpha=.01) + #3
#annotate(geom="text", x=as.Date("2021-06-15"), color="black", y=60100, size=3, label="3")+
geom_rect(aes(xmin = as.Date("2021-08-01"), xmax = as.Date("2022-12-31"), ymin=-Inf, ymax=Inf), fill="#00FFFF", alpha=.01) + #4
#annotate(geom="text", x=as.Date("2022-04-01"), color="black", y=60100, size=3, label="4")+
labs(x= "Date",
y = "Total number of Scottish A&E attendances")
Covid_aeScotlandactivity_encodingtimeline2018to2022<- ggplot(data=Covid_monthlyae_activity_timeline, aes(x=date, y=NumberOfAttendancesAll))+
geom_point()+
geom_line(size=1,colour="black")+
geom_label(aes(label= ("1 Lockdown \n 2 Tightening \n 3 Easing \n 4 No restriction"),x=as.Date("2018-11-01"), y=90000))+
#legend("bottomleft", inset=0.2, title="Restrictions", c("1 Lockdown", "2 Tightening", "3 Easing", "4 No restrictions"), col=c("#FF0033", "#FF00CC", "#9966FF", "#00FFFF", lty=1:2, cex=0.8)) +
geom_rect(aes(xmin = as.Date("2018-01-01"), xmax = as.Date("2020-03-31"), ymin=-Inf, ymax=Inf), fill="#00FFFF", alpha=.01) + #4
#annotate(geom="text", x=as.Date("2019-02-28"), color="black", y=60100, size=3, label="4")+
geom_rect(aes(xmin = as.Date("2020-04-01"), xmax = as.Date("2020-05-31"), ymin=-Inf, ymax=Inf), fill="#FF0033", alpha=.01) + #1
#annotate(geom="text", x=as.Date("2020-04-30"), color="black", y=60100, size=3, label="1")+
geom_rect(aes(xmin = as.Date("2020-06-01"), xmax = as.Date("2020-09-30"), ymin=-Inf, ymax=Inf), fill="#9900FF", alpha=.01) + #3
#annotate(geom="text", x=as.Date("2020-07-30"), color="black", y=60100, size=3, label="3")+
geom_rect(aes(xmin = as.Date("2020-10-01"), xmax = as.Date("2020-12-31"), ymin=-Inf, ymax=Inf), fill="#FF00CC", alpha=.01) + #2
#annotate(geom="text", x=as.Date("2020-11-15"), color="black", y=60100, size=3, label="2")+
geom_rect(aes(xmin = as.Date("2021-01-01"), xmax = as.Date("2021-04-30"), ymin=-Inf, ymax=Inf), fill="#FF0033", alpha=.01) + #1
#annotate(geom="text", x=as.Date("2021-03-01"), color="black", y=60100, size=3, label="1")+
geom_rect(aes(xmin = as.Date("2021-05-01"), xmax = as.Date("2021-07-31"), ymin=-Inf, ymax=Inf), fill="#9900FF", alpha=.01) + #3
#annotate(geom="text", x=as.Date("2021-06-15"), color="black", y=60100, size=3, label="3")+
geom_rect(aes(xmin = as.Date("2021-08-01"), xmax = as.Date("2022-12-31"), ymin=-Inf, ymax=Inf), fill="#00FFFF", alpha=.01) + #4
#annotate(geom="text", x=as.Date("2022-04-01"), color="black", y=60100, size=3, label="4")+
labs(x= "Date",
y = "Total number of Scottish A&E attendances")
save_plot("Output/Covid_aeScotlandactivity_encodingtimeline2018to2022.svg", fig=Covid_aeScotlandactivity_encodingtimeline2018to2022, width=14, height=12)
library(tidyverse)
library(here)
library(readxl)
library(dplyr)
library(ggplot2)
library(lubridate)
library(sf)
library(scales)
library(sjPlot)
ggplot(data=Covid_monthlyae_activity_timeline, aes(x=date, y=NumberOfAttendancesAll))+
geom_point()+
geom_line(size=1,colour="black")+
geom_label(aes(label= ("1 Lockdown \n 2 Tightening \n 3 Easing \n 4 No restriction"),x=as.Date("2018-11-01"), y=90000))+
#legend("bottomleft", inset=0.2, title="Restrictions", c("1 No or minimal restrictions \n 2 Easing \n 3 Tightening \n 4 Lockdown"), col=c("#FF0033", "#FF00CC", "#9966FF", "#00FFFF", lty=1:2, cex=0.8)) +
geom_rect(aes(xmin = as.Date("2018-01-01"), xmax = as.Date("2020-03-31"), ymin=-Inf, ymax=Inf), fill="#00FFFF", alpha=.01) + #1
#annotate(geom="text", x=as.Date("2019-02-28"), color="black", y=60100, size=3, label="1")+
geom_rect(aes(xmin = as.Date("2020-04-01"), xmax = as.Date("2020-05-31"), ymin=-Inf, ymax=Inf), fill="#FF0033", alpha=.01) + #4
#annotate(geom="text", x=as.Date("2020-04-30"), color="black", y=60100, size=3, label="4")+
geom_rect(aes(xmin = as.Date("2020-06-01"), xmax = as.Date("2020-09-30"), ymin=-Inf, ymax=Inf), fill="#9900FF", alpha=.01) + #2
#annotate(geom="text", x=as.Date("2020-07-30"), color="black", y=60100, size=3, label="2")+
geom_rect(aes(xmin = as.Date("2020-10-01"), xmax = as.Date("2020-12-31"), ymin=-Inf, ymax=Inf), fill="#FF00CC", alpha=.01) + #3
#annotate(geom="text", x=as.Date("2020-11-15"), color="black", y=60100, size=3, label="3")+
geom_rect(aes(xmin = as.Date("2021-01-01"), xmax = as.Date("2021-04-30"), ymin=-Inf, ymax=Inf), fill="#FF0033", alpha=.01) + #4
#annotate(geom="text", x=as.Date("2021-03-01"), color="black", y=60100, size=3, label="4")+
geom_rect(aes(xmin = as.Date("2021-05-01"), xmax = as.Date("2021-07-31"), ymin=-Inf, ymax=Inf), fill="#9900FF", alpha=.01) + #2
#annotate(geom="text", x=as.Date("2021-06-15"), color="black", y=60100, size=3, label="2")+
geom_rect(aes(xmin = as.Date("2021-08-01"), xmax = as.Date("2022-12-31"), ymin=-Inf, ymax=Inf), fill="#00FFFF", alpha=.01) + #1
#annotate(geom="text", x=as.Date("2022-04-01"), color="black", y=60100, size=3, label="1")+
labs(x= "Date",
y = "Total number of Scottish A&E attendances")
ggplot(data=Covid_monthlyae_activity_timeline, aes(x=date, y=NumberOfAttendancesAll))+
geom_point()+
geom_line(size=1,colour="black")+
geom_label(aes(label= ("1 Lockdown \n 2 Tightening \n 3 Easing \n 4 No or minimal restriction"),x=as.Date("2018-11-01"), y=90000))+
#legend("bottomleft", inset=0.2, title="Restrictions", c("1 No or minimal restrictions \n 2 Easing \n 3 Tightening \n 4 Lockdown"), col=c("#FF0033", "#FF00CC", "#9966FF", "#00FFFF", lty=1:2, cex=0.8)) +
geom_rect(aes(xmin = as.Date("2018-01-01"), xmax = as.Date("2020-03-31"), ymin=-Inf, ymax=Inf), fill="#00FFFF", alpha=.01) + #1
#annotate(geom="text", x=as.Date("2019-02-28"), color="black", y=60100, size=3, label="1")+
geom_rect(aes(xmin = as.Date("2020-04-01"), xmax = as.Date("2020-05-31"), ymin=-Inf, ymax=Inf), fill="#FF0033", alpha=.01) + #4
#annotate(geom="text", x=as.Date("2020-04-30"), color="black", y=60100, size=3, label="4")+
geom_rect(aes(xmin = as.Date("2020-06-01"), xmax = as.Date("2020-09-30"), ymin=-Inf, ymax=Inf), fill="#9900FF", alpha=.01) + #2
#annotate(geom="text", x=as.Date("2020-07-30"), color="black", y=60100, size=3, label="2")+
geom_rect(aes(xmin = as.Date("2020-10-01"), xmax = as.Date("2020-12-31"), ymin=-Inf, ymax=Inf), fill="#FF00CC", alpha=.01) + #3
#annotate(geom="text", x=as.Date("2020-11-15"), color="black", y=60100, size=3, label="3")+
geom_rect(aes(xmin = as.Date("2021-01-01"), xmax = as.Date("2021-04-30"), ymin=-Inf, ymax=Inf), fill="#FF0033", alpha=.01) + #4
#annotate(geom="text", x=as.Date("2021-03-01"), color="black", y=60100, size=3, label="4")+
geom_rect(aes(xmin = as.Date("2021-05-01"), xmax = as.Date("2021-07-31"), ymin=-Inf, ymax=Inf), fill="#9900FF", alpha=.01) + #2
#annotate(geom="text", x=as.Date("2021-06-15"), color="black", y=60100, size=3, label="2")+
geom_rect(aes(xmin = as.Date("2021-08-01"), xmax = as.Date("2022-12-31"), ymin=-Inf, ymax=Inf), fill="#00FFFF", alpha=.01) + #1
#annotate(geom="text", x=as.Date("2022-04-01"), color="black", y=60100, size=3, label="1")+
labs(x= "Date",
y = "Total number of Scottish A&E attendances")
ggplot(data=Covid_monthlyae_activity_timeline, aes(x=date, y=NumberOfAttendancesAll))+
geom_point()+
geom_line(size=1,colour="black")+
geom_label(aes(label= ("1 Lockdown \n 2 Tightening \n 3 Easing \n 4 No or minimal restrictions"),x=as.Date("2018-11-01"), y=90000))+
#legend("bottomleft", inset=0.2, title="Restrictions", c("1 No or minimal restrictions \n 2 Easing \n 3 Tightening \n 4 Lockdown"), col=c("#FF0033", "#FF00CC", "#9966FF", "#00FFFF", lty=1:2, cex=0.8)) +
geom_rect(aes(xmin = as.Date("2018-01-01"), xmax = as.Date("2020-03-31"), ymin=-Inf, ymax=Inf), fill="#00FFFF", alpha=.01) + #1
#annotate(geom="text", x=as.Date("2019-02-28"), color="black", y=60100, size=3, label="1")+
geom_rect(aes(xmin = as.Date("2020-04-01"), xmax = as.Date("2020-05-31"), ymin=-Inf, ymax=Inf), fill="#FF0033", alpha=.01) + #4
#annotate(geom="text", x=as.Date("2020-04-30"), color="black", y=60100, size=3, label="4")+
geom_rect(aes(xmin = as.Date("2020-06-01"), xmax = as.Date("2020-09-30"), ymin=-Inf, ymax=Inf), fill="#9900FF", alpha=.01) + #2
#annotate(geom="text", x=as.Date("2020-07-30"), color="black", y=60100, size=3, label="2")+
geom_rect(aes(xmin = as.Date("2020-10-01"), xmax = as.Date("2020-12-31"), ymin=-Inf, ymax=Inf), fill="#FF00CC", alpha=.01) + #3
#annotate(geom="text", x=as.Date("2020-11-15"), color="black", y=60100, size=3, label="3")+
geom_rect(aes(xmin = as.Date("2021-01-01"), xmax = as.Date("2021-04-30"), ymin=-Inf, ymax=Inf), fill="#FF0033", alpha=.01) + #4
#annotate(geom="text", x=as.Date("2021-03-01"), color="black", y=60100, size=3, label="4")+
geom_rect(aes(xmin = as.Date("2021-05-01"), xmax = as.Date("2021-07-31"), ymin=-Inf, ymax=Inf), fill="#9900FF", alpha=.01) + #2
#annotate(geom="text", x=as.Date("2021-06-15"), color="black", y=60100, size=3, label="2")+
geom_rect(aes(xmin = as.Date("2021-08-01"), xmax = as.Date("2022-12-31"), ymin=-Inf, ymax=Inf), fill="#00FFFF", alpha=.01) + #1
#annotate(geom="text", x=as.Date("2022-04-01"), color="black", y=60100, size=3, label="1")+
labs(x= "Date",
y = "Total number of Scottish A&E attendances")
Covid_aeScotlandactivity_encodingtimeline2018to2022<- ggplot(data=Covid_monthlyae_activity_timeline, aes(x=date, y=NumberOfAttendancesAll))+
geom_point()+
geom_line(size=1,colour="black")+
geom_label(aes(label= ("1 Lockdown \n 2 Tightening \n 3 Easing \n 4 No or minimal restrictions"),x=as.Date("2018-11-01"), y=90000))+
#legend("bottomleft", inset=0.2, title="Restrictions", c("1 No or minimal restrictions \n 2 Easing \n 3 Tightening \n 4 Lockdown"), col=c("#FF0033", "#FF00CC", "#9966FF", "#00FFFF", lty=1:2, cex=0.8)) +
geom_rect(aes(xmin = as.Date("2018-01-01"), xmax = as.Date("2020-03-31"), ymin=-Inf, ymax=Inf), fill="#00FFFF", alpha=.01) + #1
#annotate(geom="text", x=as.Date("2019-02-28"), color="black", y=60100, size=3, label="1")+
geom_rect(aes(xmin = as.Date("2020-04-01"), xmax = as.Date("2020-05-31"), ymin=-Inf, ymax=Inf), fill="#FF0033", alpha=.01) + #4
#annotate(geom="text", x=as.Date("2020-04-30"), color="black", y=60100, size=3, label="4")+
geom_rect(aes(xmin = as.Date("2020-06-01"), xmax = as.Date("2020-09-30"), ymin=-Inf, ymax=Inf), fill="#9900FF", alpha=.01) + #2
#annotate(geom="text", x=as.Date("2020-07-30"), color="black", y=60100, size=3, label="2")+
geom_rect(aes(xmin = as.Date("2020-10-01"), xmax = as.Date("2020-12-31"), ymin=-Inf, ymax=Inf), fill="#FF00CC", alpha=.01) + #3
#annotate(geom="text", x=as.Date("2020-11-15"), color="black", y=60100, size=3, label="3")+
geom_rect(aes(xmin = as.Date("2021-01-01"), xmax = as.Date("2021-04-30"), ymin=-Inf, ymax=Inf), fill="#FF0033", alpha=.01) + #4
#annotate(geom="text", x=as.Date("2021-03-01"), color="black", y=60100, size=3, label="4")+
geom_rect(aes(xmin = as.Date("2021-05-01"), xmax = as.Date("2021-07-31"), ymin=-Inf, ymax=Inf), fill="#9900FF", alpha=.01) + #2
#annotate(geom="text", x=as.Date("2021-06-15"), color="black", y=60100, size=3, label="2")+
geom_rect(aes(xmin = as.Date("2021-08-01"), xmax = as.Date("2022-12-31"), ymin=-Inf, ymax=Inf), fill="#00FFFF", alpha=.01) + #1
#annotate(geom="text", x=as.Date("2022-04-01"), color="black", y=60100, size=3, label="1")+
labs(x= "Date",
y = "Total number of Scottish A&E attendances")
save_plot("Output/Covid_aeScotlandactivity_encodingtimeline2018to2022.svg", fig=Covid_aeScotlandactivity_encodingtimeline2018to2022, width=14, height=12)
Covid_aeScotlandactivity_encodingtimeline2018to2022<- ggplot(data=Covid_monthlyae_activity_timeline, aes(x=date, y=NumberOfAttendancesAll))+
geom_point()+
geom_line(size=1,colour="black")+
geom_label(aes(label= ("1 Lockdown \n 2 Tightening \n 3 Easing \n 4 No or minimal restrictions"),x=as.Date("2018-11-01"), y=90000))+
#legend("bottomleft", inset=0.2, title="Restrictions", c("1 No or minimal restrictions \n 2 Easing \n 3 Tightening \n 4 Lockdown"), col=c("#FF0033", "#FF00CC", "#9966FF", "#00FFFF", lty=1:2, cex=0.8)) +
geom_rect(aes(xmin = as.Date("2018-01-01"), xmax = as.Date("2020-03-31"), ymin=-Inf, ymax=Inf), fill="#00FFFF", alpha=.01) + #1
#annotate(geom="text", x=as.Date("2019-02-28"), color="black", y=60100, size=3, label="1")+
geom_rect(aes(xmin = as.Date("2020-04-01"), xmax = as.Date("2020-05-31"), ymin=-Inf, ymax=Inf), fill="#FF0033", alpha=.01) + #4
#annotate(geom="text", x=as.Date("2020-04-30"), color="black", y=60100, size=3, label="4")+
geom_rect(aes(xmin = as.Date("2020-06-01"), xmax = as.Date("2020-09-30"), ymin=-Inf, ymax=Inf), fill="#9900FF", alpha=.01) + #2
#annotate(geom="text", x=as.Date("2020-07-30"), color="black", y=60100, size=3, label="2")+
geom_rect(aes(xmin = as.Date("2020-10-01"), xmax = as.Date("2020-12-31"), ymin=-Inf, ymax=Inf), fill="#FF00CC", alpha=.01) + #3
#annotate(geom="text", x=as.Date("2020-11-15"), color="black", y=60100, size=3, label="3")+
geom_rect(aes(xmin = as.Date("2021-01-01"), xmax = as.Date("2021-04-30"), ymin=-Inf, ymax=Inf), fill="#FF0033", alpha=.01) + #4
#annotate(geom="text", x=as.Date("2021-03-01"), color="black", y=60100, size=3, label="4")+
geom_rect(aes(xmin = as.Date("2021-05-01"), xmax = as.Date("2021-07-31"), ymin=-Inf, ymax=Inf), fill="#9900FF", alpha=.01) + #2
#annotate(geom="text", x=as.Date("2021-06-15"), color="black", y=60100, size=3, label="2")+
geom_rect(aes(xmin = as.Date("2021-08-01"), xmax = as.Date("2022-12-31"), ymin=-Inf, ymax=Inf), fill="#00FFFF", alpha=.01) + #1
#annotate(geom="text", x=as.Date("2022-04-01"), color="black", y=60100, size=3, label="1")+
labs(x= "Date",
y = "Total number of Scottish A&E attendances")
save_plot("Output/Covid_aeScotlandactivity_encodingtimeline2018to2022.svg", fig=Covid_aeScotlandactivity_encodingtimeline2018to2022, width=18, height=12)
Covid_aeScotlandactivity_encodingtimeline2018to2022<- ggplot(data=Covid_monthlyae_activity_timeline, aes(x=date, y=NumberOfAttendancesAll))+
geom_point()+
geom_line(size=1,colour="black")+
geom_label(aes(label= ("1 Lockdown \n 2 Tightening \n 3 Easing \n 4 No or minimal restrictions"),x=as.Date("2018-11-01"), y=90000))+
#legend("bottomleft", inset=0.2, title="Restrictions", c("1 No or minimal restrictions \n 2 Easing \n 3 Tightening \n 4 Lockdown"), col=c("#FF0033", "#FF00CC", "#9966FF", "#00FFFF", lty=1:2, cex=0.8)) +
geom_rect(aes(xmin = as.Date("2018-01-01"), xmax = as.Date("2020-03-31"), ymin=-Inf, ymax=Inf), fill="#00FFFF", alpha=.01) + #1
#annotate(geom="text", x=as.Date("2019-02-28"), color="black", y=60100, size=3, label="1")+
geom_rect(aes(xmin = as.Date("2020-04-01"), xmax = as.Date("2020-05-31"), ymin=-Inf, ymax=Inf), fill="#FF0033", alpha=.01) + #4
#annotate(geom="text", x=as.Date("2020-04-30"), color="black", y=60100, size=3, label="4")+
geom_rect(aes(xmin = as.Date("2020-06-01"), xmax = as.Date("2020-09-30"), ymin=-Inf, ymax=Inf), fill="#9900FF", alpha=.01) + #2
#annotate(geom="text", x=as.Date("2020-07-30"), color="black", y=60100, size=3, label="2")+
geom_rect(aes(xmin = as.Date("2020-10-01"), xmax = as.Date("2020-12-31"), ymin=-Inf, ymax=Inf), fill="#FF00CC", alpha=.01) + #3
#annotate(geom="text", x=as.Date("2020-11-15"), color="black", y=60100, size=3, label="3")+
geom_rect(aes(xmin = as.Date("2021-01-01"), xmax = as.Date("2021-04-30"), ymin=-Inf, ymax=Inf), fill="#FF0033", alpha=.01) + #4
#annotate(geom="text", x=as.Date("2021-03-01"), color="black", y=60100, size=3, label="4")+
geom_rect(aes(xmin = as.Date("2021-05-01"), xmax = as.Date("2021-07-31"), ymin=-Inf, ymax=Inf), fill="#9900FF", alpha=.01) + #2
#annotate(geom="text", x=as.Date("2021-06-15"), color="black", y=60100, size=3, label="2")+
geom_rect(aes(xmin = as.Date("2021-08-01"), xmax = as.Date("2022-12-31"), ymin=-Inf, ymax=Inf), fill="#00FFFF", alpha=.01) + #1
#annotate(geom="text", x=as.Date("2022-04-01"), color="black", y=60100, size=3, label="1")+
labs(x= "Date",
y = "Total number of Scottish A&E attendances")
save_plot("Output/Covid_aeScotlandactivity_encodingtimeline2018to2022.svg", fig=Covid_aeScotlandactivity_encodingtimeline2018to2022, width=20, height=12)
get wd()
getwd()
install.packages("tidyverse")
install.packages("here")
install.packages("dplyr")
install.packages("ggplot2")
install.packages("sf")
library(tidyverse)
library(here)
library(readxl)
library(dplyr)
library(ggplot2)
library(lubridate)
library(sf)
library(scales)
library(sjPlot)
#Loading population estimate (only till 2022) csv file
Covid_HBpopulation_demographic <- read_csv(here("Rawdata", "20240809Popestimate_HB2019_1981to2022.csv"))
#Filtering out total Scottish estimates for 2022. Note HB=S92000003 is for all of Scotland.
Covid_HBpopulation_demographic <- Covid_HBpopulation_demographic %>%
select(Year, HB, Sex, AllAges) %>%
filter(Year=="2022")
View(Covid_HBpopulation_demographic)
#Covid_HBpopulation_demographic_sex <-
Covid_HBpopulation_demographic_sex %>%
filter(HB=="S92000003", !Sex="All") %>%
#Covid_HBpopulation_demographic_sex <-
Covid_HBpopulation_demographic %>%
filter(HB=="S92000003", !Sex="All") %>%
#Covid_HBpopulation_demographic_sex <-
Covid_HBpopulation_demographic %>%
filter(HB=="S92000003", !Sex=="All") %>%
table(Covid_HBpopulation_demographic_sex$Sex, Covid_HBpopulation_demographic_sex$AllAges)
#Covid_HBpopulation_demographic_sex <-
Covid_HBpopulation_demographic %>%
filter(HB=="S92000003", !Sex=="All") %>%
table(Covid_HBpopulation_demographic$Sex, Covid_HBpopulation_demographic$AllAges)
Covid_HBpopulation_demographic_sex <-
Covid_HBpopulation_demographic %>%
filter(HB=="S92000003", !Sex=="All")
table(Covid_HBpopulation_demographic_sex$Sex, Covid_HBpopulation_demographic_sex$AllAges)
View(Covid_HBpopulation_demographic_sex)
#Loading population estimate (only till 2022) csv file
Covid_HBpopulation_demographic <- read_csv(here("Rawdata", "20240809Popestimate_HB2019_1981to2022.csv"))
#Filtering out total Scottish estimates for 2022. Note HB=S92000003 is for all of Scotland.
Covid_HBpopulation_demographic <- Covid_HBpopulation_demographic %>%
filter(Year=="2022")
View(Covid_HBpopulation_demographic)
#Population breakdown by sex in 2022 for S92000003 (whole of Scotland)
Covid_HBpopulation_demographic_sex <-
Covid_HBpopulation_demographic %>%
select(Year, HB, Sex, AllAges) %>%
filter(HB=="S92000003", !Sex=="All")
View(Covid_HBpopulation_demographic_sex)
#Population breakdown by age ranges under18, 18-24, 25-39, 40-64, 65-74, 75plus
#Covid_HBpopulation_demographic_age <-
Covid_HBpopulation_demographic %>%
filter(HB=="S92000003")
#Population breakdown by age ranges under18, 18-24, 25-39, 40-64, 65-74, 75plus
#Covid_HBpopulation_demographic_age <-
Covid_HBpopulation_demographic %>%
filter(HB=="S92000003") %>%
sum(Age0,Age1,Age2,Age3,Age4,Age5,Age6,Age7,Age8,Age9,Age10,Age11,Age12,Age13,Age14,Age15,Age16,Age17)
str(Covid_HBpopulation_demographic)
#Population breakdown by age ranges under18, 18-24, 25-39, 40-64, 65-74, 75plus
#Covid_HBpopulation_demographic_age <-
Covid_HBpopulation_demographic_age %>%
filter(HB=="S92000003")
#Population breakdown by age ranges under18, 18-24, 25-39, 40-64, 65-74, 75plus
Covid_HBpopulation_demographic_age <- Covid_HBpopulation_demographic_age %>%
filter(HB=="S92000003")
#Population breakdown by age ranges under18, 18-24, 25-39, 40-64, 65-74, 75plus
Covid_HBpopulation_demographic_age <- Covid_HBpopulation_demographic %>%
filter(HB=="S92000003")
View(Covid_HBpopulation_demographic_age)
#Population breakdown by age ranges under18, 18-24, 25-39, 40-64, 65-74, 75plus
Covid_HBpopulation_demographic_age <- Covid_HBpopulation_demographic %>%
filter(HB=="S92000003", Sex=="All")
View(Covid_HBpopulation_demographic_age)
sum(Age0,Age1,Age2,Age3,Age4,Age5,Age6,Age7,Age8,Age9,Age10,Age11,Age12,Age13,Age14,Age15,Age16,Age17)
sum("Age0","Age1","Age2")
sum(Covid_HBpopulation_demographic_age$Age0,Covid_HBpopulation_demographic_age$Age1,Covid_HBpopulation_demographic_age$Age2)
#sum of under 18s
sum(Covid_HBpopulation_demographic_age$Age0,Covid_HBpopulation_demographic_age$Age1,Covid_HBpopulation_demographic_age$Age2, Covid_HBpopulation_demographic_age$Age3,Covid_HBpopulation_demographic_age$Age4,Covid_HBpopulation_demographic_age$Age5,Covid_HBpopulation_demographic_age$Age6,Covid_HBpopulation_demographic_age$Age7,Covid_HBpopulation_demographic_age$Age8,Covid_HBpopulation_demographic_age$Age9,Covid_HBpopulation_demographic_age$Age10,Covid_HBpopulation_demographic_age$Age11,Covid_HBpopulation_demographic_age$Age12,Covid_HBpopulation_demographic_age$Age13,Covid_HBpopulation_demographic_age$Age14,Covid_HBpopulation_demographic_age$Age15,Covid_HBpopulation_demographic_age$Age16,Covid_HBpopulation_demographic_age$Age17)
#sum of 18-24 =
sum(Covid_HBpopulation_demographic_age$Age18,Covid_HBpopulation_demographic_age$Age19,Covid_HBpopulation_demographic_age$Age20, Covid_HBpopulation_demographic_age$Age21,Covid_HBpopulation_demographic_age$Age22,Covid_HBpopulation_demographic_age$Age23,Covid_HBpopulation_demographic_age$Age24)
#sum of 25-39 =
sum(Covid_HBpopulation_demographic_age$Age25,Covid_HBpopulation_demographic_age$Age26,Covid_HBpopulation_demographic_age$Age27, Covid_HBpopulation_demographic_age$Age28,Covid_HBpopulation_demographic_age$Age29,Covid_HBpopulation_demographic_age$Age30,Covid_HBpopulation_demographic_age$Age31,Covid_HBpopulation_demographic_age$Age32,Covid_HBpopulation_demographic_age$Age33,Covid_HBpopulation_demographic_age$Age34,Covid_HBpopulation_demographic_age$Age35,Covid_HBpopulation_demographic_age$Age36,Covid_HBpopulation_demographic_age$Age37,Covid_HBpopulation_demographic_age$Age38,Covid_HBpopulation_demographic_age$Age39)
#sum of 40-64 =
sum(Covid_HBpopulation_demographic_age$Age0,Covid_HBpopulation_demographic_age$Age40,Covid_HBpopulation_demographic_age$Age41, Covid_HBpopulation_demographic_age$Age42,Covid_HBpopulation_demographic_age$Age43,Covid_HBpopulation_demographic_age$Age44,Covid_HBpopulation_demographic_age$Age45,Covid_HBpopulation_demographic_age$Age46,Covid_HBpopulation_demographic_age$Age47,Covid_HBpopulation_demographic_age$Age48,Covid_HBpopulation_demographic_age$Age49,Covid_HBpopulation_demographic_age$Age50,Covid_HBpopulation_demographic_age$Age51,Covid_HBpopulation_demographic_age$Age52,Covid_HBpopulation_demographic_age$Age53,Covid_HBpopulation_demographic_age$Age54,Covid_HBpopulation_demographic_age$Age55,Covid_HBpopulation_demographic_age$Age56, Covid_HBpopulation_demographic_age$Age57, Covid_HBpopulation_demographic_age$Age58, Covid_HBpopulation_demographic_age$Age59, Covid_HBpopulation_demographic_age$Age60, Covid_HBpopulation_demographic_age$Age61, Covid_HBpopulation_demographic_age$Age62, Covid_HBpopulation_demographic_age$Age63, Covid_HBpopulation_demographic_age$Age64)
#sum of 65-74 =
sum(Covid_HBpopulation_demographic_age$Age65,Covid_HBpopulation_demographic_age$Age66,Covid_HBpopulation_demographic_age$Age67, Covid_HBpopulation_demographic_age$Age68,Covid_HBpopulation_demographic_age$Age69,Covid_HBpopulation_demographic_age$Age70,Covid_HBpopulation_demographic_age$Age71,Covid_HBpopulation_demographic_age$Age72,Covid_HBpopulation_demographic_age$Age73,Covid_HBpopulation_demographic_age$Age74)
#sum of 75 plus =
sum(Covid_HBpopulation_demographic_age$Age75,Covid_HBpopulation_demographic_age$Age76,Covid_HBpopulation_demographic_age$Age77, Covid_HBpopulation_demographic_age$Age78,Covid_HBpopulation_demographic_age$Age79,Covid_HBpopulation_demographic_age$Age80,Covid_HBpopulation_demographic_age$Age81,Covid_HBpopulation_demographic_age$Age82,Covid_HBpopulation_demographic_age$Age83,Covid_HBpopulation_demographic_age$Age84,Covid_HBpopulation_demographic_age$Age85,Covid_HBpopulation_demographic_age$Age86,Covid_HBpopulation_demographic_age$Age87,Covid_HBpopulation_demographic_age$Age88,Covid_HBpopulation_demographic_age$Age89,Covid_HBpopulation_demographic_age$Age90plus)
View(Covid_HBpopulation_demographic_sex)
View(Covid_HBpopulation_demographic_sex)
sum(1006212/(1006212+466541+1044051+1880687+599485+497910))
sum((1006212/(1006212+466541+1044051+1880687+599485+497910))*100)
sum((466541/(1006212+466541+1044051+1880687+599485+497910))*100)
sum((1044051/(1006212+466541+1044051+1880687+599485+497910))*100)
sum((1880687/(1006212+466541+1044051+1880687+599485+497910))*100)
sum((199485/(1006212+466541+1044051+1880687+599485+497910))*100)
sum((497910/(1006212+466541+1044051+1880687+599485+497910))*100)
library(tidyverse)
library(here)
library(readxl)
library(dplyr)
library(ggplot2)
library(lubridate)
library(sf)
library(scales)
library(sjPlot)
#SIMD
#Loading population estimate by SIMD
Covid_HBpopulation_demographic_SIMD <- read_excel(here("Rawdata", "population-estimates_by_scottish_index_of_multiple_deprivation_simd_2020_decile_by_nhs_board_area_2001_2021.xlsx"))
View(Covid_HBpopulation_demographic_SIMD)
#SIMD
#Loading population estimate by SIMD
Covid_HBpopulation_demographic_SIMD <- read_excel(here("Rawdata", "population-estimates_by_scottish_index_of_multiple_deprivation_simd_2020_decile_by_nhs_board_area_2001_2021.xlsx", sheet = "2021"))
#SIMD
#Loading population estimate by SIMD
Covid_HBpopulation_demographic_SIMD <- read_excel(here("Rawdata", "population-estimates_by_scottish_index_of_multiple_deprivation_simd_2020_decile_by_nhs_board_area_2001_2021.xlsx"), sheet = "2021")
View(Covid_HBpopulation_demographic_SIMD)
Covid_HBpopulation_demographic_SIMD <- slice_head(Covid_HBpopulation_demographic_SIMD, n=-3)
View(Covid_HBpopulation_demographic_SIMD)
Covid_HBpopulation_demographic_SIMD <- slice_head(Covid_HBpopulation_demographic_SIMD, n=-3)
View(Covid_HBpopulation_demographic_SIMD)
Covid_HBpopulation_demographic_SIMD <- tail(Covid_HBpopulation_demographic_SIMD,-3)
View(Covid_HBpopulation_demographic_SIMD)
#SIMD
#Loading population estimate by SIMD
Covid_HBpopulation_demographic_SIMD <- read_excel(here("Rawdata", "population-estimates_by_scottish_index_of_multiple_deprivation_simd_2020_decile_by_nhs_board_area_2001_2021.xlsx"), sheet = "2021")
View(Covid_HBpopulation_demographic_SIMD)
View(Covid_HBpopulation_demographic_SIMD)
#SIMD
#Loading population estimate by SIMD
Covid_HBpopulation_demographic_SIMD <- read_excel(here("Rawdata", "population-estimates_by_scottish_index_of_multiple_deprivation_simd_2020_decile_by_nhs_board_area_2001_2021.xlsx"), sheet = "2021", skip = 3)
View(Covid_HBpopulation_demographic_SIMD)
Covid_HBpopulation_demographic_SIMD <- Covid_HBpopulation_demographic_SIMD %>%
select("Health board area", "SIMD decile", "Total") %>%
filter(!"Health board area"= "Scotland")
Covid_HBpopulation_demographic_SIMD <- Covid_HBpopulation_demographic_SIMD %>%
select("Health board area", "SIMD decile", "Total") %>%
filter(!"Health board area"== "Scotland")
View(Covid_HBpopulation_demographic_SIMD)
Covid_HBpopulation_demographic_SIMD <- Covid_HBpopulation_demographic_SIMD %>%
select("Health board area", "SIMD decile", "Total") %>%
filter("Health board area"== !"Scotland")
#SIMD
#Loading population estimate by SIMD
Covid_HBpopulation_demographic_SIMD <- read_excel(here("Rawdata", "population-estimates_by_scottish_index_of_multiple_deprivation_simd_2020_decile_by_nhs_board_area_2001_2021.xlsx"), sheet = "2021", skip = 3)
Covid_HBpopulation_demographic_SIMD <- Covid_HBpopulation_demographic_SIMD %>%
select("Health board area", "SIMD decile", "Total") %>%
filter("Health board area"== !"Scotland")
#SIMD
#Loading population estimate by SIMD
Covid_HBpopulation_demographic_SIMD <- read_excel(here("Rawdata", "population-estimates_by_scottish_index_of_multiple_deprivation_simd_2020_decile_by_nhs_board_area_2001_2021.xlsx"), sheet = "2021", skip = 3)
Covid_HBpopulation_demographic_SIMD <- Covid_HBpopulation_demographic_SIMD %>%
select("Health board area", "SIMD decile", "Total") %>%
filter(!"Health board area" == "Scotland")
View(Covid_HBpopulation_demographic_SIMD)
str(Covid_HBpopulation_demographic_SIMD)
Covid_HBpopulation_demographic_SIMD %>% filter("SIMD decile"=1,"SIMD decile"=2) %>%
sum(Total)
Covid_HBpopulation_demographic_SIMD %>% filter("SIMD decile"==1,"SIMD decile"==2) %>%
sum(Total)
Covid_HBpopulation_demographic_SIMD %>% filter("SIMD decile"==1,"SIMD decile"==2) %>%
sum("Total")
Covid_HBpopulation_demographic_SIMD <- Covid_HBpopulation_demographic_SIMD %>%
group_by(`SIMD decile`) %>%
summarise(Total=sum(Total))
View(Covid_HBpopulation_demographic_SIMD)
sum("SIMD decile"=1, "SIMD decile"=2)
Covid_HBpopulation_demographic_SIMD %>%
filter("SIMD decile"==1, "SIMD decile"==2) %>%
sum(Total)
Covid_HBpopulation_demographic_SIMD %>%
filter("SIMD decile"==1, "SIMD decile"==2) %>%
summarise(Total=sum(Total))
Covid_HBpopulation_demographic_SIMD %>%
filter("SIMD decile"=="1", "SIMD decile"=="2") %>%
rowsum()
Covid_HBpopulation_demographic_SIMD1_2 <- Covid_HBpopulation_demographic_SIMD %>%
filter("SIMD decile"=="1", "SIMD decile"=="2")
View(Covid_HBpopulation_demographic_SIMD1_2)
